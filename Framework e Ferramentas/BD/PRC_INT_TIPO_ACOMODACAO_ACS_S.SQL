create or replace procedure PRC_INT_TIPO_ACOMODACAO_ACS_S
  (
     pCAD_CNV_ID_CONVENIO IN TB_ASS_CTA_CONV_TPATEND.CAD_CNV_ID_CONVENIO%type,
     pCAD_PLA_ID_PLANO    IN TB_ASS_CTP_CNV_UN_TPACOM_PLA.CAD_PLA_ID_PLANO%type DEFAULT NULL,
     pCAD_UNI_ID_UNIDADE  IN TB_CAD_UNI_UNIDADE.CAD_UNI_ID_UNIDADE%type DEFAULT NULL,
     pCODEST              IN BNF_BENEFICIARIO.CODEST%TYPE DEFAULT NULL,
     pCODBEN              IN BNF_BENEFICIARIO.CODBEN%TYPE DEFAULT NULL,
     pCODSEQBEN           IN BNF_BENEFICIARIO.CODSEQBEN%TYPE DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor
  )
  is
  /********************************************************************
  *    Procedure: PRC_INT_TIPO_ACOMODACAO_ACS_S
  *
  *    Data Criacao:     04/02/2011   Por: Fabiola Lopes
  *    Data Alteracao:                Por:

  *    Funcao: Lista os Tipos de Acomodações do ACS
  *
  *******************************************************************/
  v_cursor PKG_CURSOR.t_cursor;
  begin
    OPEN v_cursor FOR
     SELECT DISTINCT UNI.CAD_UNI_ID_UNIDADE,
                UNI.CAD_UNI_DS_UNIDADE,
                CNV.CAD_CNV_ID_CONVENIO,
                TPL.CAD_PLA_ID_PLANO,
                CNV.CAD_CNV_CD_HAC_PRESTADOR,
                TAC.TIS_TAC_CD_TIPO_ACOMODACAO,
                TAC.TIS_TAC_DS_TIPO_ACOMODACAO,
                CUT.ASS_CUT_ID,
                TPL.ASS_CTP_DT_INI_VIGENCIA,
                TPL.ASS_CTP_DT_FIM_VIGENCIA,
                TPL.ASS_CTP_PC_HM_ACOMODACAO,
                TPL.ASS_CTP_PC_HM_ARTROSCOPIA,
                TPL.ASS_CTP_PC_HM_LAPAROSCOPIA,
                PLA.CAD_PLA_CD_PLANO_HAC
  FROM TB_ASS_CNU_CONVENIO_UNIDADE CNU
 INNER JOIN TB_CAD_UNI_UNIDADE UNI
    ON UNI.CAD_UNI_ID_UNIDADE = CNU.CAD_UNI_ID_UNIDADE
 INNER JOIN TB_CAD_CNV_CONVENIO CNV
    ON CNV.CAD_CNV_ID_CONVENIO = CNU.CAD_CNV_ID_CONVENIO
 INNER JOIN TB_ASS_UTA_UNID_TPACOMOD UTA
    ON UTA.CAD_UNI_ID_UNIDADE = UNI.CAD_UNI_ID_UNIDADE
 INNER JOIN TB_ASS_CUT_CONV_UNI_TPACOMOD CUT
    ON (CUT.ASS_UTA_ID_UNID_TPACOMOD = UTA.ASS_UTA_ID_UNID_TPACOMOD AND
       CUT.ASS_CNU_ID = CNU.ASS_CNU_ID)
 INNER JOIN TB_TIS_TAC_TIPO_ACOMODACAO TAC
    ON TAC.TIS_TAC_CD_TIPO_ACOMODACAO = UTA.TIS_TAC_CD_TIPO_ACOMODACAO
 INNER JOIN TB_ASS_CTP_CNV_UN_TPACOM_PLA TPL
    ON CUT.ASS_CUT_ID = TPL.ASS_CUT_ID
 INNER JOIN TB_CAD_PLA_PLANO PLA
    ON PLA.CAD_PLA_ID_PLANO = TPL.CAD_PLA_ID_PLANO
 INNER JOIN BNF_BENEFICIARIO BNF
    ON BNF.CODCON = PLA.CAD_PLA_CD_PLANO_HAC
   AND BNF.CODEST = pCODEST
   AND BNF.CODBEN = pCODBEN
   AND BNF.CODSEQBEN = pCODSEQBEN
   AND BNF.CODSITBEN = 1
 INNER JOIN TB_CAD_TAA_TIPO_ACOMODACAO_ACS TAA
    ON TAA.TIS_TAC_CD_TIPO_ACOMODACAO = TAC.TIS_TAC_CD_TIPO_ACOMODACAO
 WHERE (UNI.CAD_UNI_FL_STATUS = 'A')
   AND (UTA.ASS_UTA_FL_ATIVO_OK = 'S')
   AND (CNV.CAD_CNV_ID_CONVENIO = pCAD_CNV_ID_CONVENIO)
   AND (pCAD_PLA_ID_PLANO IS NULL OR TPL.CAD_PLA_ID_PLANO = pCAD_PLA_ID_PLANO)
   AND (pCAD_UNI_ID_UNIDADE IS NULL OR UNI.CAD_UNI_ID_UNIDADE = pCAD_UNI_ID_UNIDADE)
   AND TAA.CAD_TAA_CD_TIPO_ACOMODACAO_ACS = BNF.CODPADATEBEN
 ORDER BY TPL.ASS_CTP_DT_FIM_VIGENCIA,
          TPL.ASS_CTP_DT_INI_VIGENCIA,
          UNI.CAD_UNI_DS_UNIDADE,
          TAC.TIS_TAC_DS_TIPO_ACOMODACAO;
    io_cursor := v_cursor;
  end PRC_INT_TIPO_ACOMODACAO_ACS_S;
