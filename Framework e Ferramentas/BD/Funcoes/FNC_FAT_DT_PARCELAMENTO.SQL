CREATE OR REPLACE FUNCTION FNC_FAT_DT_PARCELAMENTO(pCAD_CNV_ID_CONVENIO in NUMBER,
                                                   pDATA_ULTIMA_PARCELA in DATE)
  return DATE is
  Result                DATE;
  QTD_DIA_CONTA_PARCIAL number;

begin

  SELECT CNV.CAD_CNV_QT_DIA_CONTA_PARCIAL
    INTO QTD_DIA_CONTA_PARCIAL
    FROM TB_CAD_CNV_CONVENIO CNV
   WHERE CNV.CAD_CNV_ID_CONVENIO = pCAD_CNV_ID_CONVENIO;

  IF (QTD_DIA_CONTA_PARCIAL IS NOT NULL) THEN
    Result := pDATA_ULTIMA_PARCELA + QTD_DIA_CONTA_PARCIAL;
  ELSE
    Result := trunc(sysdate);
  END IF;

  return(Result);
end FNC_FAT_DT_PARCELAMENTO;

