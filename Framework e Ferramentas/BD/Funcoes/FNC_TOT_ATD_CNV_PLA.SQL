create or replace function FNC_TOT_ATD_CNV_PLA(PLANO in NUMERIC, CONVENIO in NUMERIC) return integer IS
TOTAL INTEGER;
begin
  
   SELECT COUNT(*) INTO TOTAL
    FROM TB_ATD_ATE_ATENDIMENTO ATE
    INNER JOIN TB_ASS_PAT_PACIEATEND PAT
     ON PAT.ATD_ATE_ID = ATE.ATD_ATE_ID
    INNER JOIN TB_CAD_PAC_PACIENTE PAC 
     ON PAC.CAD_PAC_ID_PACIENTE = PAT.CAD_PAC_ID_PACIENTE
     AND PAC.CAD_CNV_ID_CONVENIO = CONVENIO 
     AND PAC.CAD_PLA_ID_PLANO = PLANO;

  return(TOTAL);
end FNC_TOT_ATD_CNV_PLA;