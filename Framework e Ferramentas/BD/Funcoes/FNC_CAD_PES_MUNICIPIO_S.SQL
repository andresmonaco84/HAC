create or replace function FNC_CAD_PES_MUNICIPIO_S
(
 PCAD_PES_ID_PESSOA in TB_CAD_PES_PESSOA.CAD_PES_ID_PESSOA%type,
 PCD_TIPO_ENDERECO in TB_CAD_TEL_TELEFONE.AUX_TTE_CD_TP_TEL_END%type
)
return TB_AUX_MUN_MUNICIPIO.AUX_MUN_NM_MUNICIPIO%type is Result TB_AUX_MUN_MUNICIPIO.AUX_MUN_NM_MUNICIPIO%type;
begin


SELECT AUX_MUN_NM_MUNICIPIO INTO Result

FROM (SELECT  MUN.AUX_MUN_NM_MUNICIPIO 
      FROM    TB_CAD_END_ENDERECO ENDE,
              TB_AUX_MUN_MUNICIPIO MUN
      WHERE   ENDE.AUX_MUN_CD_IBGE = MUN.AUX_MUN_CD_IBGE
      AND     ENDE.CAD_PES_ID_PESSOA = PCAD_PES_ID_PESSOA
      AND     ENDE.AUX_TTE_CD_TP_TEL_END = PCD_TIPO_ENDERECO
      order by ende.cad_end_dt_ultima_atualizacao desc
      )
WHERE rownum = 1 ;  

  return(Result);
end FNC_CAD_PES_MUNICIPIO_S;
