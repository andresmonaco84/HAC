CREATE OR REPLACE PROCEDURE PRC_FAT_BRASINDICE_RESTRITO IS
BEGIN
  DECLARE
    CONT NUMBER;
    CURSOR RESTRITO IS
    
      /*SELECT SIM.CAD_SIM_NM_MNEMONICO
        FROM TB_CAD_SIM_SIMPRO SIM, TB_CAD_BRA_BRASINDICE BRA
       WHERE SIM.CAD_SIM_FL_RESTRITO = 'S'
         AND SIM.CAD_SIM_NM_MNEMONICO = BRA.CAD_BRA_NM_MNEMONICO
         AND SIM.CAD_SIM_NM_MNEMONICO IS NOT NULL
         AND SIM.CAD_SIM_ID_IDENTIFICACAO <> 'L'
         AND SIM.CAD_SIM_TP_ALTERACAO <> 'L';  */
       
       SELECT BRA.CAD_BRA_ID
       FROM   TB_CAD_BRA_BRASINDICE BRA
       WHERE  BRA.CAD_BRA_DS_PRODUTO LIKE '%Restrito Hosp.%';
       
  BEGIN
    CONT := 0;
    FOR A IN RESTRITO LOOP
    
      UPDATE TB_CAD_BRA_BRASINDICE BRA
         SET BRA.CAD_BRA_FL_RESTRITO = 'S'
       WHERE BRA.CAD_BRA_ID = A.CAD_BRA_ID;
    
      CONT := CONT + 1;
    
      IF CONT = 100 THEN
        COMMIT;
        CONT := 0;
      END IF;
    END LOOP;
    COMMIT;
  END;
END PRC_FAT_BRASINDICE_RESTRITO;
 
