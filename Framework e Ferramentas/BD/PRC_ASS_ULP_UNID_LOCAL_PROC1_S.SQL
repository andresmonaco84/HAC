create or replace procedure PRC_ASS_ULP_UNID_LOCAL_PROC1_S
  (
     pASS_ULP_ID IN TB_ASS_ULP_UNID_LOCAL_PROCED.ASS_ULP_ID%type DEFAULT NULL,
     pCAD_UNI_ID_UNIDADE IN TB_ASS_ULP_UNID_LOCAL_PROCED.CAD_UNI_ID_UNIDADE%TYPE DEFAULT NULL,
     pCAD_LAT_ID_LOCAL_ATENDIMENTO IN TB_ASS_ULP_UNID_LOCAL_PROCED.CAD_LAT_ID_LOCAL_ATENDIMENTO%TYPE DEFAULT NULL,
     pCAD_SET_ID IN TB_ASS_ULP_UNID_LOCAL_PROCED.CAD_SET_ID%TYPE DEFAULT NULL,
     pAGE_SAU_ID IN TB_ASS_ULP_UNID_LOCAL_PROCED.AGE_SAU_ID%TYPE DEFAULT NULL,
     pAUX_EPP_CD_ESPECPROCED IN TB_ASS_ULP_UNID_LOCAL_PROCED.AUX_EPP_CD_ESPECPROCED%TYPE DEFAULT NULL,
     pAUX_GPC_CD_GRUPOPROC IN TB_ASS_ULP_UNID_LOCAL_PROCED.AUX_GPC_CD_GRUPOPROC%TYPE DEFAULT NULL,
     pCAD_PRD_CD_CODIGO IN TB_ASS_ULP_UNID_LOCAL_PROCED.CAD_PRD_CD_CODIGO%TYPE DEFAULT NULL,
     pTIS_MED_CD_TABELAMEDICA IN TB_ASS_ULP_UNID_LOCAL_PROCED.TIS_MED_CD_TABELAMEDICA%TYPE DEFAULT NULL,
     pCAD_PRD_ID IN TB_ASS_ULP_UNID_LOCAL_PROCED.CAD_PRD_ID%TYPE DEFAULT NULL,
     pCAD_PRD_DS_DESCRICAO IN TB_CAD_PRD_PRODUTO.CAD_PRD_DS_DESCRICAO%TYPE DEFAULT NULL,
     pCAD_PRD_NM_MNEMONICO IN TB_CAD_PRD_PRODUTO.CAD_PRD_NM_MNEMONICO%TYPE DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor
  )
  is
  /********************************************************************
  *    Procedure: PRC_ASS_ULP_UNID_LOCAL_PROC1_S
  *
  *    Data Criacao:   15/09/2008           Por: Fabiola Lopes
  *    Data Alteracao:  data da alteração  Por: Nome do Analista
  *
  *    Funcao: Listar as Associacoes de Unidade x Local x Procedimentos
  *
  *******************************************************************/
  v_cursor PKG_CURSOR.t_cursor;
  begin
    OPEN v_cursor FOR

    SELECT DISTINCT
       ULP.ASS_ULP_ID,
       ULP.CAD_UNI_ID_UNIDADE,
       ULP.CAD_LAT_ID_LOCAL_ATENDIMENTO,
       ULP.AUX_EPP_CD_ESPECPROCED,
       ULP.AUX_GPC_CD_GRUPOPROC,
       ULP.CAD_PRD_CD_CODIGO,
       ULP.ASS_ULP_FL_STATUS,
       ULP.ASS_ULP_DT_ULTIMA_ATUALIZACAO,
       ULP.SEG_USU_ID_USUARIO,
       ULP.CAD_SET_ID,
       ULP.AGE_SAU_ID,
       PRD.CAD_PRD_DS_DESCRICAO,
       ULP.ASS_ULP_QT_HORA_RESERVADA,
       ULP.ASS_ULP_FL_LIB_AGE_SADT,
       ULP.ASS_ULP_FL_EXI_PREP_AGESADT,
       ULP.TIS_MED_CD_TABELAMEDICA,
       ULP.CAD_PRD_ID,
       ULP.ASS_ULP_HR_LIMITE_AGE_SADT,
       PRD.CAD_PRD_NM_MNEMONICO

    FROM TB_ASS_ULP_UNID_LOCAL_PROCED ULP,
         TB_CAD_PRD_PRODUTO PRD

   WHERE
          (pASS_ULP_ID is null OR ULP.ASS_ULP_ID = pASS_ULP_ID)
     AND  (pCAD_UNI_ID_UNIDADE IS NULL OR ULP.CAD_UNI_ID_UNIDADE = pCAD_UNI_ID_UNIDADE)
     AND  (pCAD_LAT_ID_LOCAL_ATENDIMENTO IS NULL OR ULP.CAD_LAT_ID_LOCAL_ATENDIMENTO = pCAD_LAT_ID_LOCAL_ATENDIMENTO)
     AND  (pCAD_SET_ID IS NULL OR CAD_SET_ID = pCAD_SET_ID)
     AND  (pAGE_SAU_ID IS NULL OR AGE_SAU_ID = pAGE_SAU_ID)
     AND  (pAUX_EPP_CD_ESPECPROCED IS NULL OR ULP.AUX_EPP_CD_ESPECPROCED = pAUX_EPP_CD_ESPECPROCED)
     AND  (pAUX_GPC_CD_GRUPOPROC IS NULL OR ULP.AUX_GPC_CD_GRUPOPROC = pAUX_GPC_CD_GRUPOPROC)
     AND  (pCAD_PRD_CD_CODIGO IS NULL OR ULP.CAD_PRD_CD_CODIGO = pCAD_PRD_CD_CODIGO)
     AND  (pTIS_MED_CD_TABELAMEDICA IS NULL OR ULP.TIS_MED_CD_TABELAMEDICA = pTIS_MED_CD_TABELAMEDICA)
     AND  (ULP.AUX_EPP_CD_ESPECPROCED = PRD.AUX_EPP_CD_ESPECPROC)
     AND  (ULP.AUX_GPC_CD_GRUPOPROC = PRD.AUX_GPC_CD_GRUPOPROC)
     AND  (ULP.CAD_PRD_ID = PRD.CAD_PRD_ID)
     AND  (ULP.TIS_MED_CD_TABELAMEDICA = PRD.TIS_MED_CD_TABELAMEDICA)
     --AND  (pASS_ULP_FL_LIB_AGE_SADT IS NULL OR ULP.ASS_ULP_FL_LIB_AGE_SADT = pASS_ULP_FL_LIB_AGE_SADT)
     AND  (pCAD_PRD_ID IS NULL OR ULP.CAD_PRD_ID = pCAD_PRD_ID)
     AND  (pCAD_PRD_DS_DESCRICAO IS NULL OR PRD.CAD_PRD_DS_DESCRICAO LIKE UPPER(pCAD_PRD_DS_DESCRICAO))
     AND  (pCAD_PRD_NM_MNEMONICO IS NULL OR PRD.CAD_PRD_NM_MNEMONICO LIKE UPPER(pCAD_PRD_NM_MNEMONICO));

    io_cursor := v_cursor;
  end PRC_ASS_ULP_UNID_LOCAL_PROC1_S;
/