CREATE OR REPLACE PROCEDURE SGS."PRC_ATD_ATENDIMENTO_R_S"
  (
     pATD_ATE_TP_PACIENTE IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_TP_PACIENTE%type DEFAULT NULL,
     pATD_ATE_ID IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_ID%type DEFAULT NULL,
     pATD_ATE_DT_ATENDIMENTO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_DT_ATENDIMENTO%type DEFAULT NULL,
     pATD_ATE_HR_ATENDIMENTO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_HR_ATENDIMENTO%type DEFAULT NULL,
     pCODPAD IN TB_ATD_ATE_ATENDIMENTO.CODPAD%type DEFAULT NULL,
     pATD_ATE_FL_CARATER_SOLIC IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_CARATER_SOLIC%type DEFAULT NULL,
     pATD_ATE_DS_INDCLINICA IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_DS_INDCLINICA%type DEFAULT NULL,
     pATD_ATE_FL_INDIC_RN_OK IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_INDIC_RN_OK%type DEFAULT NULL,
     pATD_ATE_FL_RETORNO_OK IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_RETORNO_OK%type DEFAULT NULL,
     pATD_ATE_DS_OBSERVACAO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_DS_OBSERVACAO%type DEFAULT NULL,
     pATD_ATE_DT_ULTIMA_ATUALIZACAO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_DT_ULTIMA_ATUALIZACAO%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO IN TB_ATD_ATE_ATENDIMENTO.SEG_USU_ID_USUARIO%type DEFAULT NULL,
     pTIS_TSC_CD_TIPOSAIDACONSULTA IN TB_ATD_ATE_ATENDIMENTO.TIS_TSC_CD_TIPOSAIDACONSULTA%type DEFAULT NULL,
     pCAD_LAT_ID_LOCAL_ATENDIMENTO IN TB_ATD_ATE_ATENDIMENTO.CAD_LAT_ID_LOCAL_ATENDIMENTO%type DEFAULT NULL,
     pCAD_CID_CD_CID10 IN TB_ATD_ATE_ATENDIMENTO.CAD_CID_CD_CID10%type DEFAULT NULL,
     pTIS_TAT_CD_TPATENDIMENTO IN TB_ATD_ATE_ATENDIMENTO.TIS_TAT_CD_TPATENDIMENTO%type DEFAULT NULL,
     pTIS_IAC_CD_INDACIDENTE IN TB_ATD_ATE_ATENDIMENTO.TIS_IAC_CD_INDACIDENTE%type DEFAULT NULL,
     pCAD_UNI_ID_UNIDADE IN TB_ATD_ATE_ATENDIMENTO.CAD_UNI_ID_UNIDADE%type DEFAULT NULL,
     pTIS_CBO_CD_CBOS IN TB_ATD_ATE_ATENDIMENTO.TIS_CBO_CD_CBOS%type DEFAULT NULL,
     pCAD_SET_ID IN TB_ATD_ATE_ATENDIMENTO.CAD_SET_ID%type DEFAULT NULL,
     pCAD_UNI_ID_UNID_PROC IN TB_ATD_ATE_ATENDIMENTO.CAD_UNI_ID_UNID_PROC%type DEFAULT NULL,
     pCODCLI IN TB_ATD_ATE_ATENDIMENTO.CODCLI%type DEFAULT NULL,
     pCAD_PRO_ID_PROF_EXEC IN TB_ATD_ATE_ATENDIMENTO.CAD_PRO_ID_PROF_EXEC%type DEFAULT NULL,
     pATD_ATE_NR_CONSELHO_SOLIC IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_NR_CONSELHO_SOLIC%type DEFAULT NULL,
     pATD_ATE_CD_UFCONSELHO_SOLIC IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_CD_UFCONSELHO_SOLIC%type DEFAULT NULL,
     pATD_ATE_FL_STATUS IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_STATUS%type DEFAULT NULL,
     pTIS_CPR_CD_CONSELHOPROF_SOLIC IN TB_ATD_ATE_ATENDIMENTO.TIS_CPR_CD_CONSELHOPROF_SOLIC%type DEFAULT NULL,
     pATD_ATE_NR_SENHA_CHAMADA IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_NR_SENHA_CHAMADA%type DEFAULT NULL,
     pATD_ATE_FL_LIBERA_EMISSAO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_LIBERA_EMISSAO%type DEFAULT NULL,
	 pATD_ATE_DS_MOTIVO_CANCELA IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_DS_MOTIVO_CANCELA%type DEFAULT NULL,
     pATD_ATE_FL_SUSPEITA_COVID19 IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_SUSPEITA_COVID19%type DEFAULT NULL,
     pATD_ATE_FL_PEDIATRIA_ONCO IN TB_ATD_ATE_ATENDIMENTO.ATD_ATE_FL_PEDIATRIA_ONCO%type DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor--,
   --  TESTE OUT  LONG
  )
  is
  /********************************************************************
  *    Procedure: PRC_ATD_ATENDIMENTO_R_S
  *
  *    Data Criacao: 	data da  cria‡Æo   Por: Nome do Analista
  *    Data Alteracao:	7/05/2012 Por: PEDRO
  *    Altera‡Æo:    V_SELECT    V_WHERE
  *
  *    Funcao: Descri‡Æo da funcionalidade da Stored Procedure
  *
  *******************************************************************/
  v_cursor PKG_CURSOR.t_cursor;
  V_WHERE  varchar2(5000);
  V_SELECT  varchar2(5000);

begin
  V_WHERE := NULL;
  IF pATD_ATE_TP_PACIENTE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_TP_PACIENTE = ' || CHR(39) || pATD_ATE_TP_PACIENTE || CHR(39); END IF;
IF pATD_ATE_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_ID = ' || pATD_ATE_ID; END IF;
IF pATD_ATE_DT_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_DT_ATENDIMENTO = TO_DATE('||CHR(39)||TO_CHAR(pATD_ATE_DT_ATENDIMENTO,'DDMMYYYY')||CHR(39)||','||CHR(39)||'DDMMYYYY'||CHR(39)|| ')' ; END IF;
IF pATD_ATE_HR_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_HR_ATENDIMENTO = ' || pATD_ATE_HR_ATENDIMENTO; END IF;
IF pCODPAD IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CODPAD = ' || CHR(39) || pCODPAD || CHR(39); END IF;
IF pATD_ATE_FL_CARATER_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_CARATER_SOLIC = ' || CHR(39) || pATD_ATE_FL_CARATER_SOLIC || CHR(39); END IF;
IF pATD_ATE_DS_INDCLINICA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_DS_INDCLINICA = ' || CHR(39) || pATD_ATE_DS_INDCLINICA || CHR(39); END IF;
IF pATD_ATE_FL_INDIC_RN_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_INDIC_RN_OK = ' || CHR(39) || pATD_ATE_FL_INDIC_RN_OK || CHR(39); END IF;
IF pATD_ATE_FL_RETORNO_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_RETORNO_OK = ' || CHR(39) || pATD_ATE_FL_RETORNO_OK || CHR(39); END IF;
IF pATD_ATE_DS_OBSERVACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_DS_OBSERVACAO = ' || CHR(39) || pATD_ATE_DS_OBSERVACAO || CHR(39); END IF;
IF pATD_ATE_DT_ULTIMA_ATUALIZACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_DT_ULTIMA_ATUALIZACAO = ' || CHR(39) || pATD_ATE_DT_ULTIMA_ATUALIZACAO || CHR(39); END IF;
IF pSEG_USU_ID_USUARIO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND SEG_USU_ID_USUARIO = ' || pSEG_USU_ID_USUARIO; END IF;
IF pTIS_TSC_CD_TIPOSAIDACONSULTA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_TSC_CD_TIPOSAIDACONSULTA = ' || pTIS_TSC_CD_TIPOSAIDACONSULTA; END IF;
IF pCAD_LAT_ID_LOCAL_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_LAT_ID_LOCAL_ATENDIMENTO = ' || pCAD_LAT_ID_LOCAL_ATENDIMENTO; END IF;
IF pCAD_CID_CD_CID10 IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_CID_CD_CID10 = ' || CHR(39) || pCAD_CID_CD_CID10 || CHR(39); END IF;
IF pTIS_TAT_CD_TPATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_TAT_CD_TPATENDIMENTO = ' || CHR(39) || pTIS_TAT_CD_TPATENDIMENTO || CHR(39); END IF;
IF pTIS_IAC_CD_INDACIDENTE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_IAC_CD_INDACIDENTE = ' || pTIS_IAC_CD_INDACIDENTE; END IF;
IF pCAD_UNI_ID_UNIDADE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_UNI_ID_UNIDADE = ' || pCAD_UNI_ID_UNIDADE; END IF;
IF pTIS_CBO_CD_CBOS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_CBO_CD_CBOS = ' || CHR(39) || pTIS_CBO_CD_CBOS || CHR(39); END IF;
IF pCAD_SET_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_SET_ID = ' || pCAD_SET_ID; END IF;
IF pCAD_UNI_ID_UNID_PROC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_UNI_ID_UNID_PROC = ' || pCAD_UNI_ID_UNID_PROC; END IF;
IF pCODCLI IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CODCLI = ' || CHR(39) || pCODCLI || CHR(39); END IF;
IF pCAD_PRO_ID_PROF_EXEC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PRO_ID_PROF_EXEC = ' || pCAD_PRO_ID_PROF_EXEC; END IF;
IF pATD_ATE_NR_CONSELHO_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_NR_CONSELHO_SOLIC = ' || CHR(39) || pATD_ATE_NR_CONSELHO_SOLIC || CHR(39); END IF;
IF pATD_ATE_CD_UFCONSELHO_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_CD_UFCONSELHO_SOLIC = ' || CHR(39) || pATD_ATE_CD_UFCONSELHO_SOLIC || CHR(39); END IF;
IF pATD_ATE_FL_STATUS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_STATUS = ' || CHR(39) || pATD_ATE_FL_STATUS || CHR(39); END IF;
IF pTIS_CPR_CD_CONSELHOPROF_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_CPR_CD_CONSELHOPROF_SOLIC = ' || CHR(39) || pTIS_CPR_CD_CONSELHOPROF_SOLIC || CHR(39); END IF;
IF pATD_ATE_NR_SENHA_CHAMADA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_NR_SENHA_CHAMADA = ' || pATD_ATE_NR_SENHA_CHAMADA; END IF;
IF pATD_ATE_FL_LIBERA_EMISSAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_LIBERA_EMISSAO = ' || CHR(39) || pATD_ATE_FL_LIBERA_EMISSAO || CHR(39); END IF;
--IF pATD_ATE_FL_ATUALIZADO_LANCAM IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_ATUALIZADO_LANCAM = ' || CHR(39) || pATD_ATE_FL_ATUALIZADO_LANCAM || CHR(39); END IF;
--IF pATD_ATE_FL_FAT_STATUS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_FAT_STATUS = ' || CHR(39) || pATD_ATE_FL_FAT_STATUS || CHR(39); END IF;
--IF pATD_ATE_FL_PRONT_ELETR_ATIVO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_PRONT_ELETR_ATIVO = ' || CHR(39) || pATD_ATE_FL_PRONT_ELETR_ATIVO || CHR(39); END IF;
--IF pATD_ATE_FL_REPASSE_STATUS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_FL_REPASSE_STATUS = ' || CHR(39) || pATD_ATE_FL_REPASSE_STATUS || CHR(39); END IF;


   V_SELECT := '
    SELECT
       ATD_ATE_TP_PACIENTE,
       ATD_ATE_ID,
       ATD_ATE_DT_ATENDIMENTO,
       ATD_ATE_HR_ATENDIMENTO,
       CODPAD,
       ATD_ATE_FL_CARATER_SOLIC,
       ATD_ATE_DS_INDCLINICA,
       ATD_ATE_FL_INDIC_RN_OK,
       ATD_ATE_FL_RETORNO_OK,
       ATD_ATE_DS_OBSERVACAO,
       ATD_ATE_DT_ULTIMA_ATUALIZACAO,
       SEG_USU_ID_USUARIO,
       TIS_TSC_CD_TIPOSAIDACONSULTA,
       CAD_LAT_ID_LOCAL_ATENDIMENTO,
       CAD_CID_CD_CID10,
       TIS_TAT_CD_TPATENDIMENTO,
       TIS_IAC_CD_INDACIDENTE,
       CAD_UNI_ID_UNIDADE,
       TIS_CBO_CD_CBOS,
       CAD_SET_ID,
       CAD_UNI_ID_UNID_PROC,
       CODCLI,
       CAD_PRO_ID_PROF_EXEC,
       ATD_ATE_NR_CONSELHO_SOLIC,
       ATD_ATE_CD_UFCONSELHO_SOLIC,
       ATD_ATE_FL_STATUS,
       TIS_CPR_CD_CONSELHOPROF_SOLIC,
       ATD_ATE_NR_SENHA_CHAMADA,
       ATD_ATE_FL_LIBERA_EMISSAO,
       ATD_ATE_DS_MOTIVO_CANCELA,
       atd_ate_fl_suspeita_covid19,
       ATD_ATE_FL_PEDIATRIA_ONCO
    FROM TB_ATD_ATE_ATENDIMENTO
    WHERE 1 = 1
        ';

--TESTE :=   V_SELECT || V_WHERE ;

OPEN v_cursor FOR
  V_SELECT || V_WHERE ;

  io_cursor := v_cursor;
end PRC_ATD_ATENDIMENTO_R_S;
