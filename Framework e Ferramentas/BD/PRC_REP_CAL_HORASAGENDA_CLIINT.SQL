CREATE OR REPLACE PROCEDURE SGS."PRC_REP_CAL_HORASAGENDA_CLIINT"
 (PREP_PGM_MES_FECHAMENTO               IN TB_REP_PGM_PAGTO_MEDICO.REP_PGM_MES_FECHAMENTO%TYPE,
  PREP_PGM_ANO_FECHAMENTO               IN TB_REP_PGM_PAGTO_MEDICO.REP_PGM_ANO_FECHAMENTO%TYPE,
  PREP_PGM_MES_PAGTO                    IN TB_REP_PGM_PAGTO_MEDICO.REP_PGM_MES_PAGTO%TYPE,
  PREP_PGM_ANO_PAGTO                    IN TB_REP_PGM_PAGTO_MEDICO.REP_PGM_ANO_PAGTO%TYPE,
  PSEG_USU_ID_USUARIO                   IN TB_REP_PPC_PAG_PROF_CLI.SEG_USU_ID_USUARIO%TYPE,
  PCAD_HTR_DT_INICIO_VIGENCIA           IN TB_CAD_HTR_HORA_TRAB.CAD_HTR_DT_INICIO_VIGENCIA%TYPE,
  PREP_PPC_FL_ANTECIPACAO               IN TB_REP_PPC_PAG_PROF_CLI.REP_PPC_FL_ANTECIPACAO%TYPE,
--  PCAD_CLC_ID                           IN STRING,
  PCAD_UNI_ID_UNIDADE                   IN STRING,
  PCAD_PRO_ID_PROFISSIONAL              IN STRING
) IS
  /********************************************************************
  *    PROCEDURE: PRC_REP_CAL_HORASAGENDA_CLIINT
  *
  *    DATA CRIACAO:    21/02/2013         POR:
  *    DATA ALTERACAO:  DATA DA ALTERAC?O  POR: NOME DO ANALISTA
  *
  *    FUNCAO:
  *
  *******************************************************************/
BEGIN
 BEGIN
  FOR TEMP IN (
--HAC
SELECT DISTINCT HORASTRAB.CAD_HTR_ID,
                CPR.CAD_CLC_ID,
                CLC.CAD_CLC_CD_CLINICA,
                CLC.CAD_CLC_DS_DESCRICAO,
                HORASTRAB.UNID,
                HORASTRAB.LOCALATEN,
                CPR.CAD_PRO_ID_PROFISSIONAL PROFISSIONAL,
                PRO.CAD_PRO_NR_CONSELHO,
                PRO.CAD_PRO_NM_NOME,      
                REP.CAD_REP_ID,          
                ROUND(NVL(HORASTRAB.PCHORASFALTAHAC, 0)) * REP.CAD_REP_VL_PAGTO PAGOFALTAHAC, 
                (HORASTRAB.CAD_HTR_QT_HORA_SEMANA - (ROUND(HORASTRAB.CAD_HTR_QT_HORA_SEMANA - HORASTRAB.PCHORASHAC))) * (HORASTRAB.CAD_HTR_VL_FATOR_MULTI_SEMANA) * REP.CAD_REP_VL_PAGTO PAGOHAC,
                0 PAGOFALTAACS,
                0 PAGOACS,
                'HAC' FONTEPAGA,
                'MF' CRED
  FROM TB_ASS_CPR_CLINICA_PROF        CPR,
       TB_CAD_REP_REGRA_PAGAMENTO     REP,
       TB_ASS_RPG_REGRA_PAGTO         RPG,
       TB_CAD_CLC_CLINICA_CREDENCIADA CLC,
       TB_CAD_PRO_PROFISSIONAL        PRO,
       TB_REP_IMPORTACAO_CLI_TEMP     ICT,
       (SELECT DISTINCT HTR.CAD_HTR_ID,
                        HTR.CAD_HTR_DT_INICIO_VIGENCIA,
                        CLC.CAD_CLC_ID,
                        CLC.CAD_CLC_CD_CLINICA,
                        DECODE(CPR.CAD_UNI_ID_UNIDADE, NULL, NVL(CPR.CAD_UNI_ID_UNIDADE, 0), HTR.CAD_UNI_ID_UNIDADE) UNID,
                        DECODE(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, NULL, NVL(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, 0), HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO) LOCALATEN,
                        HTR.TIS_CBO_CD_CBOS, 
                        DECODE(CPR.TIS_CBO_CD_CBOS, NULL, 0, CPR.TIS_CBO_CD_CBOS) CPRESPEC,
                        CPR.CAD_PRO_ID_PROFISSIONAL,
                        PRO.CAD_PRO_NR_CONSELHO,
                        PRO.CAD_PRO_NM_NOME,
                        REP.CAD_REP_VL_PAGTO,
                        HTR.CAD_HTR_QT_HORA_SEMANA,
                        HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA,
                        HTR.CAD_HTR_QT_HORA_FIM_SEMANA,
                        HTR.CAD_HTR_VL_FATOR_MULTI_FIMSEM,
                        RPG.ASS_RPG_PC_HAC,
                        RPG.ASS_RPG_PC_ACS,
                        (HTR.CAD_HTR_QT_HORA_SEMANA * RPG.ASS_RPG_PC_HAC) / 100 PCHORASHAC,
                        (HTR.CAD_HTR_QT_HORA_SEMANA * RPG.ASS_RPG_PC_ACS) / 100 PCHORASACS,
                        (HFA.CAD_HFA_QT_HR_FALTA_SEMANA * RPG.ASS_RPG_PC_HAC) / 100 PCHORASFALTAHAC,
                        (HFA.CAD_HFA_QT_HR_FALTA_SEMANA * RPG.ASS_RPG_PC_ACS) / 100 PCHORASFALTAACS,
                        (((HTR.CAD_HTR_QT_HORA_SEMANA * HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA) * CAD_REP_VL_PAGTO) * RPG.ASS_RPG_PC_HAC) / 100 PAGOHAC,
                        (((HTR.CAD_HTR_QT_HORA_SEMANA * HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA) * CAD_REP_VL_PAGTO) * RPG.ASS_RPG_PC_ACS) / 100 PAGOACS
          FROM TB_ASS_CPR_CLINICA_PROF        CPR,
               TB_CAD_REP_REGRA_PAGAMENTO     REP,
               TB_ASS_RPG_REGRA_PAGTO         RPG,
               TB_CAD_HTR_HORA_TRAB           HTR,
               TB_CAD_CLC_CLINICA_CREDENCIADA CLC,
               TB_CAD_PRO_PROFISSIONAL        PRO,
               TB_CAD_HFA_HORAS_FALTA         HFA,
               TB_REP_IMPORTACAO_CLI_TEMP     ICT
         WHERE CPR.ASS_CPR_ID = RPG.ASS_CPR_ID
           AND REP.CAD_REP_ID = RPG.CAD_REP_ID
           AND REP.CAD_REP_TP_BASE_CALCULO = ('VLHORA')
           AND CLC.CAD_CLC_ID = CPR.CAD_CLC_ID
           AND PRO.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
           AND HTR.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
           AND HTR.CAD_PRO_ID_PROFISSIONAL IS NOT NULL
           AND HTR.CAD_HTR_DT_INICIO_VIGENCIA = PCAD_HTR_DT_INICIO_VIGENCIA
           AND CPR.CAD_UNI_ID_UNIDADE = HTR.CAD_UNI_ID_UNIDADE
           AND CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO = HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO
           AND (CPR.TIS_CBO_CD_CBOS = HTR.TIS_CBO_CD_CBOS OR CPR.TIS_CBO_CD_CBOS IS NULL)
           AND RPG.CAD_REP_DT_FIM_VIGENCIA IS NULL
           AND HTR.CAD_HTR_ID = HFA.CAD_HTR_ID(+)
           AND HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA > 1
           AND HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO = 27
           --AND CLC.CAD_CLC_ID IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_CLC_ID)))
           AND CLC.CAD_CLC_ID = ICT.CAD_CLC_ID
           AND (PCAD_UNI_ID_UNIDADE IS NULL OR CPR.CAD_UNI_ID_UNIDADE IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_UNI_ID_UNIDADE))))
           AND (PCAD_PRO_ID_PROFISSIONAL IS NULL OR CPR.CAD_PRO_ID_PROFISSIONAL IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_PRO_ID_PROFISSIONAL))))
        ) HORASTRAB
 WHERE CPR.ASS_CPR_ID = RPG.ASS_CPR_ID
   AND REP.CAD_REP_ID = RPG.CAD_REP_ID
   AND CPR.CAD_CLC_ID = CLC.CAD_CLC_ID
   AND CLC.CAD_CLC_ID = CPR.CAD_CLC_ID
   AND REP.CAD_REP_TP_BASE_CALCULO IN ('VLHORA')
   AND PRO.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
   AND CPR.ASS_CPR_DT_FIM_VIGENCIA IS NULL
   AND RPG.CAD_REP_DT_FIM_VIGENCIA IS NULL
   AND CPR.CAD_CLC_ID = HORASTRAB.CAD_CLC_ID
   AND CPR.CAD_PRO_ID_PROFISSIONAL = HORASTRAB.CAD_PRO_ID_PROFISSIONAL
   AND (CPR.CAD_TPE_CD_CODIGO IS NULL OR CPR.CAD_TPE_CD_CODIGO <> 'ACS')
   AND CPR.CAD_UNI_ID_UNIDADE = HORASTRAB.UNID
   AND (NVL(CPR.CAD_UNI_ID_UNIDADE, 0)) = (NVL(HORASTRAB.UNID, 0))
   AND (NVL(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, 0)) = (NVL(HORASTRAB.LOCALATEN, 0))
   AND (NVL(CPR.TIS_CBO_CD_CBOS, 0)) = HORASTRAB.CPRESPEC
   AND NVL(RPG.ASS_RPG_PC_HAC, 0) > 0
   AND HORASTRAB.CAD_HTR_DT_INICIO_VIGENCIA = PCAD_HTR_DT_INICIO_VIGENCIA
   --AND CLC.CAD_CLC_ID IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_CLC_ID)))
   AND CLC.CAD_CLC_ID = ICT.CAD_CLC_ID
   AND (PCAD_UNI_ID_UNIDADE IS NULL OR CPR.CAD_UNI_ID_UNIDADE IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_UNI_ID_UNIDADE))))
   AND (PCAD_PRO_ID_PROFISSIONAL IS NULL OR CPR.CAD_PRO_ID_PROFISSIONAL IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_PRO_ID_PROFISSIONAL))))
   AND NOT EXISTS (SELECT *
                     FROM TB_REP_PPC_PAG_PROF_CLI PPC
                    WHERE PPC.CAD_HTR_ID = HORASTRAB.CAD_HTR_ID
                      AND PPC.REP_PPC_MES_PAGTO = PREP_PGM_MES_PAGTO
                      AND PPC.REP_PPC_ANO_PAGTO = PREP_PGM_ANO_PAGTO
                      AND PPC.CAD_CLC_ID = CPR.CAD_CLC_ID
                      AND PPC.CAD_REP_TP_BASE_CALCULO = 'VLHORA'
                      AND PPC.REP_PPC_FONTE_PAGADORA = 'HAC'
                      AND PPC.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
                      AND PPC.CAD_UNI_ID_UNIDADE = CPR.CAD_UNI_ID_UNIDADE
                      AND PPC.CAD_LAT_ID_LOCAL = CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO)
UNION ALL 
SELECT DISTINCT HORASTRAB.CAD_HTR_ID,
                CPR.CAD_CLC_ID,
                CLC.CAD_CLC_CD_CLINICA,
                CLC.CAD_CLC_DS_DESCRICAO,
                HORASTRAB.UNID,
                HORASTRAB.LOCALATEN,
                CPR.CAD_PRO_ID_PROFISSIONAL PROFISSIONAL,               
                PRO.CAD_PRO_NR_CONSELHO,
                PRO.CAD_PRO_NM_NOME,    
                REP.CAD_REP_ID,    
                0 PAGOFALTAHAC, 
                0 PAGOHAC,                                    
                ROUND(NVL(HORASTRAB.PCHORASFALTAACS, 0)) * REP.CAD_REP_VL_PAGTO PAGOFALTAACS,
                (ROUND(HORASTRAB.CAD_HTR_QT_HORA_SEMANA - HORASTRAB.PCHORASHAC) * (HORASTRAB.CAD_HTR_VL_FATOR_MULTI_SEMANA)) * REP.CAD_REP_VL_PAGTO PAGOACS,              
                'ACS' FONTEPAGA,
                'MC' CRED
  FROM TB_ASS_CPR_CLINICA_PROF CPR,
       TB_CAD_REP_REGRA_PAGAMENTO REP,
       TB_ASS_RPG_REGRA_PAGTO RPG,
       TB_CAD_CLC_CLINICA_CREDENCIADA CLC,
       TB_CAD_PRO_PROFISSIONAL PRO,
       TB_REP_IMPORTACAO_CLI_TEMP     ICT,
       (SELECT DISTINCT HTR.CAD_HTR_ID,
                        HTR.CAD_HTR_DT_INICIO_VIGENCIA,
                        CLC.CAD_CLC_ID,
                        CLC.CAD_CLC_CD_CLINICA,
                        DECODE(CPR.CAD_UNI_ID_UNIDADE, NULL, NVL(CPR.CAD_UNI_ID_UNIDADE, 0), HTR.CAD_UNI_ID_UNIDADE) UNID,
                        DECODE(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, NULL, NVL(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, 0), HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO) LOCALATEN,
                        HTR.TIS_CBO_CD_CBOS, 
                        DECODE(CPR.TIS_CBO_CD_CBOS, NULL, 0, CPR.TIS_CBO_CD_CBOS) CPRESPEC,
                        CPR.CAD_PRO_ID_PROFISSIONAL,
                        PRO.CAD_PRO_NR_CONSELHO,
                        PRO.CAD_PRO_NM_NOME,
                        REP.CAD_REP_VL_PAGTO,
                        HTR.CAD_HTR_QT_HORA_SEMANA,
                        HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA,
                        HTR.CAD_HTR_QT_HORA_FIM_SEMANA,
                        HTR.CAD_HTR_VL_FATOR_MULTI_FIMSEM,
                        RPG.ASS_RPG_PC_HAC,
                        RPG.ASS_RPG_PC_ACS,
                        (HTR.CAD_HTR_QT_HORA_SEMANA * RPG.ASS_RPG_PC_HAC) / 100 PCHORASHAC,
                        (HTR.CAD_HTR_QT_HORA_SEMANA * RPG.ASS_RPG_PC_ACS) / 100 PCHORASACS,
                        (HFA.CAD_HFA_QT_HR_FALTA_SEMANA * RPG.ASS_RPG_PC_HAC) / 100 PCHORASFALTAHAC,
                        (HFA.CAD_HFA_QT_HR_FALTA_SEMANA * RPG.ASS_RPG_PC_ACS) / 100 PCHORASFALTAACS,
                        (((HTR.CAD_HTR_QT_HORA_SEMANA * HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA) * CAD_REP_VL_PAGTO) * RPG.ASS_RPG_PC_HAC) / 100 PAGOHAC,
                        (((HTR.CAD_HTR_QT_HORA_SEMANA * HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA) * CAD_REP_VL_PAGTO) * RPG.ASS_RPG_PC_ACS) / 100 PAGOACS
          FROM TB_ASS_CPR_CLINICA_PROF        CPR,
               TB_CAD_REP_REGRA_PAGAMENTO     REP,
               TB_ASS_RPG_REGRA_PAGTO         RPG,
               TB_CAD_HTR_HORA_TRAB           HTR,
               TB_CAD_CLC_CLINICA_CREDENCIADA CLC,
               TB_CAD_PRO_PROFISSIONAL        PRO,
               TB_CAD_HFA_HORAS_FALTA         HFA,
               TB_REP_IMPORTACAO_CLI_TEMP     ICT
         WHERE CPR.ASS_CPR_ID = RPG.ASS_CPR_ID
           AND REP.CAD_REP_ID = RPG.CAD_REP_ID
           AND REP.CAD_REP_TP_BASE_CALCULO = ('VLHORA')
           AND CLC.CAD_CLC_ID = CPR.CAD_CLC_ID
           AND PRO.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
           AND HTR.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
           AND HTR.CAD_PRO_ID_PROFISSIONAL IS NOT NULL
           AND HTR.CAD_HTR_DT_INICIO_VIGENCIA = PCAD_HTR_DT_INICIO_VIGENCIA
           AND CPR.CAD_UNI_ID_UNIDADE = HTR.CAD_UNI_ID_UNIDADE
           AND CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO = HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO
           AND (CPR.TIS_CBO_CD_CBOS = HTR.TIS_CBO_CD_CBOS OR CPR.TIS_CBO_CD_CBOS IS NULL)
           AND RPG.CAD_REP_DT_FIM_VIGENCIA IS NULL
           AND HTR.CAD_HTR_ID = HFA.CAD_HTR_ID(+)
           AND HTR.CAD_HTR_VL_FATOR_MULTI_SEMANA > 1
           AND HTR.CAD_LAT_ID_LOCAL_ATENDIMENTO = 27
           --AND CLC.CAD_CLC_ID IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_CLC_ID)))
           AND CLC.CAD_CLC_ID = ICT.CAD_CLC_ID
           AND (PCAD_UNI_ID_UNIDADE IS NULL OR CPR.CAD_UNI_ID_UNIDADE IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_UNI_ID_UNIDADE))))
           AND (PCAD_PRO_ID_PROFISSIONAL IS NULL OR CPR.CAD_PRO_ID_PROFISSIONAL IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_PRO_ID_PROFISSIONAL))))
        ) HORASTRAB
 WHERE CPR.ASS_CPR_ID = RPG.ASS_CPR_ID
   AND REP.CAD_REP_ID = RPG.CAD_REP_ID
   AND CPR.CAD_CLC_ID = CLC.CAD_CLC_ID
   AND CLC.CAD_CLC_ID = CPR.CAD_CLC_ID
   AND REP.CAD_REP_TP_BASE_CALCULO IN ('VLHORA')
   AND PRO.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
   AND CPR.ASS_CPR_DT_FIM_VIGENCIA IS NULL
   AND RPG.CAD_REP_DT_FIM_VIGENCIA IS NULL
   AND CPR.CAD_CLC_ID = HORASTRAB.CAD_CLC_ID
   AND CPR.CAD_PRO_ID_PROFISSIONAL = HORASTRAB.CAD_PRO_ID_PROFISSIONAL
   AND (CPR.CAD_TPE_CD_CODIGO IS NULL OR CPR.CAD_TPE_CD_CODIGO = 'ACS')
   AND CPR.CAD_UNI_ID_UNIDADE = HORASTRAB.UNID
   AND (NVL(CPR.CAD_UNI_ID_UNIDADE, 0)) = (NVL(HORASTRAB.UNID, 0))
   AND (NVL(CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO, 0)) = (NVL(HORASTRAB.LOCALATEN, 0))
   AND (NVL(CPR.TIS_CBO_CD_CBOS, 0)) = HORASTRAB.CPRESPEC
   AND NVL(RPG.ASS_RPG_PC_ACS, 0) > 0
   AND HORASTRAB.CAD_HTR_DT_INICIO_VIGENCIA = PCAD_HTR_DT_INICIO_VIGENCIA
   --AND CLC.CAD_CLC_ID IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_CLC_ID)))
   AND CLC.CAD_CLC_ID = ICT.CAD_CLC_ID
   AND (PCAD_UNI_ID_UNIDADE IS NULL OR CPR.CAD_UNI_ID_UNIDADE IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_UNI_ID_UNIDADE))))
   AND (PCAD_PRO_ID_PROFISSIONAL IS NULL OR CPR.CAD_PRO_ID_PROFISSIONAL IN (SELECT * FROM TABLE(FNC_SPLIT(PCAD_PRO_ID_PROFISSIONAL))))
   AND NOT EXISTS (SELECT *
                     FROM TB_REP_PPC_PAG_PROF_CLI PPC
                    WHERE PPC.CAD_HTR_ID = HORASTRAB.CAD_HTR_ID
                      AND PPC.REP_PPC_MES_PAGTO = PREP_PGM_MES_PAGTO
                      AND PPC.REP_PPC_ANO_PAGTO = PREP_PGM_ANO_PAGTO
                      AND PPC.CAD_CLC_ID = CPR.CAD_CLC_ID
                      AND PPC.CAD_REP_TP_BASE_CALCULO = 'VLHORA'
                      AND PPC.REP_PPC_FONTE_PAGADORA = 'ACS'
                      AND PPC.CAD_PRO_ID_PROFISSIONAL = CPR.CAD_PRO_ID_PROFISSIONAL
                      AND PPC.CAD_UNI_ID_UNIDADE = CPR.CAD_UNI_ID_UNIDADE
                      AND PPC.CAD_LAT_ID_LOCAL = CPR.CAD_LAT_ID_LOCAL_ATENDIMENTO)
 )
   LOOP
    BEGIN
      INSERT INTO TB_REP_PPC_PAG_PROF_CLI PPC
        (PPC.REP_PPC_ID,
         PPC.CAD_CLC_ID,
         PPC.CAD_UNI_ID_UNIDADE,
         PPC.CAD_LAT_ID_LOCAL,
         PPC.CAD_PRO_ID_PROFISSIONAL,
         PPC.REP_PPC_VL_PAGO_HAC,
         PPC.REP_PPC_VL_PAGO_ACS,
         PPC.REP_PPC_MES_FECHAMENTO,
         PPC.REP_PPC_ANO_FECHAMENTO,
         PPC.REP_PPC_MES_PAGTO,
         PPC.REP_PPC_ANO_PAGTO,
         PPC.SEG_USU_ID_USUARIO,
         PPC.REP_PPC_DT_ULTIMA_ATUALIZACAO,
         PPC.REP_PPC_FL_PAGTO,
         PPC.CAD_REP_TP_BASE_CALCULO,
         PPC.REP_PPC_FONTE_PAGADORA,
         PPC.REP_PPC_TP_CREDENCIA_PROF,
         PPC.CAD_HTR_ID,
         PPC.REP_PPC_FL_ANTECIPACAO,
         PPC.CAD_REP_ID)
      VALUES
        (SEQ_REP_PPC_01.NEXTVAL,
         TEMP.CAD_CLC_ID,
         TEMP.UNID,
         TEMP.LOCALATEN,
         TEMP.PROFISSIONAL,
         (TEMP.PAGOHAC - TEMP.PAGOFALTAHAC),
         (TEMP.PAGOACS - TEMP.PAGOFALTAACS),
         PREP_PGM_MES_FECHAMENTO,
         PREP_PGM_ANO_FECHAMENTO,
         PREP_PGM_MES_PAGTO,
         PREP_PGM_ANO_PAGTO,
         PSEG_USU_ID_USUARIO,
         SYSDATE,
         'P',
         'VLHORA',
         TEMP.FONTEPAGA,
         TEMP.CRED,
         TEMP.CAD_HTR_ID,
         pREP_PPC_FL_ANTECIPACAO,
         TEMP.CAD_REP_ID);
   END;
  END LOOP;
  COMMIT;
 END;
END PRC_REP_CAL_HORASAGENDA_CLIINT;