CREATE OR REPLACE PROCEDURE "PRC_CTS_REL_03"
(
     pCTS_RES_RESU_MES1       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO1       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES2       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO2       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES3       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO3       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES4       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO4       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES5       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO5       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES6       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO6       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES7       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO7       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES8       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO8       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES9       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO9       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES10      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO10      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES11      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO11      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES12      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO12      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     IO_CURSOR                OUT PKG_CURSOR.T_CURSOR
  )
  IS
  v_cursor PKG_CURSOR.t_cursor;
  v_AnoMesInicio NUMBER;
  v_AnoMesFim    NUMBER;

BEGIN
  v_AnoMesInicio := pCTS_RES_RESU_ANO12||LPAD(pCTS_RES_RESU_MES12,2,'0'); 
  v_AnoMesFim    := pCTS_RES_RESU_ANO1||LPAD(pCTS_RES_RESU_MES1,2,'0');

  OPEN v_cursor FOR
    SELECT RES.CTS_RES_RESU_TIPO              TIPO,
           RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL  NIVEL,
           RES.CTS_RES_RESU_CAD_CTS_DS_DESCRI DESCRICAO,
           RES.CTS_RES_RESU_CAD_CTS_CD_CONTA  CONTA,

           SUM(MES1.PERC_DIRETO_1)        PERC_DIRETO_1,
           SUM(MES2.PERC_DIRETO_2)        PERC_DIRETO_2,
           SUM(MES3.PERC_DIRETO_3)        PERC_DIRETO_3,
           SUM(MES4.PERC_DIRETO_4)        PERC_DIRETO_4,
           SUM(MES5.PERC_DIRETO_5)        PERC_DIRETO_5,
           SUM(MES6.PERC_DIRETO_6)        PERC_DIRETO_6,
           SUM(MES7.PERC_DIRETO_7)        PERC_DIRETO_7,
           SUM(MES8.PERC_DIRETO_8)        PERC_DIRETO_8,
           SUM(MES9.PERC_DIRETO_9)        PERC_DIRETO_9,
           SUM(MES10.PERC_DIRETO_10)      PERC_DIRETO_10,
           SUM(MES11.PERC_DIRETO_11)      PERC_DIRETO_11,
           SUM(MES12.PERC_DIRETO_12)      PERC_DIRETO_12,
           SUM(MES1.TOTAL_PERC_DIRETO1)   TOTAL_PERC_DIRETO1,
           SUM(MES2.TOTAL_PERC_DIRETO2)   TOTAL_PERC_DIRETO2,
           SUM(MES3.TOTAL_PERC_DIRETO3)   TOTAL_PERC_DIRETO3,
           SUM(MES4.TOTAL_PERC_DIRETO4)   TOTAL_PERC_DIRETO4,
           SUM(MES5.TOTAL_PERC_DIRETO5)   TOTAL_PERC_DIRETO5,
           SUM(MES6.TOTAL_PERC_DIRETO6)   TOTAL_PERC_DIRETO6,
           SUM(MES7.TOTAL_PERC_DIRETO7)   TOTAL_PERC_DIRETO7,
           SUM(MES8.TOTAL_PERC_DIRETO8)   TOTAL_PERC_DIRETO8,
           SUM(MES9.TOTAL_PERC_DIRETO9)   TOTAL_PERC_DIRETO9,
           SUM(MES10.TOTAL_PERC_DIRETO10) TOTAL_PERC_DIRETO10,
           SUM(MES11.TOTAL_PERC_DIRETO11) TOTAL_PERC_DIRETO11,
           SUM(MES12.TOTAL_PERC_DIRETO12) TOTAL_PERC_DIRETO12,

           SUM(MES1.PERC_TOTAL_1)         PERC_TOTAL_1,
           SUM(MES2.PERC_TOTAL_2)         PERC_TOTAL_2,
           SUM(MES3.PERC_TOTAL_3)         PERC_TOTAL_3,
           SUM(MES4.PERC_TOTAL_4)         PERC_TOTAL_4,
           SUM(MES5.PERC_TOTAL_5)         PERC_TOTAL_5,
           SUM(MES6.PERC_TOTAL_6)         PERC_TOTAL_6,
           SUM(MES7.PERC_TOTAL_7)         PERC_TOTAL_7,
           SUM(MES8.PERC_TOTAL_8)         PERC_TOTAL_8,
           SUM(MES9.PERC_TOTAL_9)         PERC_TOTAL_9,
           SUM(MES10.PERC_TOTAL_10)       PERC_TOTAL_10,
           SUM(MES11.PERC_TOTAL_11)       PERC_TOTAL_11,
           SUM(MES12.PERC_TOTAL_12)       PERC_TOTAL_12,
           SUM(MES1.TOTAL_PERC_TOTAL1)    TOTAL_PERC_TOTAL1,
           SUM(MES2.TOTAL_PERC_TOTAL2)    TOTAL_PERC_TOTAL2,
           SUM(MES3.TOTAL_PERC_TOTAL3)    TOTAL_PERC_TOTAL3,
           SUM(MES4.TOTAL_PERC_TOTAL4)    TOTAL_PERC_TOTAL4,
           SUM(MES5.TOTAL_PERC_TOTAL5)    TOTAL_PERC_TOTAL5,
           SUM(MES6.TOTAL_PERC_TOTAL6)    TOTAL_PERC_TOTAL6,
           SUM(MES7.TOTAL_PERC_TOTAL7)    TOTAL_PERC_TOTAL7,
           SUM(MES8.TOTAL_PERC_TOTAL8)    TOTAL_PERC_TOTAL8,
           SUM(MES9.TOTAL_PERC_TOTAL9)    TOTAL_PERC_TOTAL9,
           SUM(MES10.TOTAL_PERC_TOTAL10)  TOTAL_PERC_TOTAL10,
           SUM(MES11.TOTAL_PERC_TOTAL11)  TOTAL_PERC_TOTAL11,
           SUM(MES12.TOTAL_PERC_TOTAL12)  TOTAL_PERC_TOTAL12

      FROM TB_CTS_RES_RESUMO_GERAL RES,

      (SELECT RES.SEQ_CTS_RES_RESUMO_01,

              RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_1,
              TOT_PERC_DIR_TOT_1.TOT_PERC_DIRETO1 TOTAL_PERC_DIRETO1,

              RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_1,
              TOT_PERC_DIR_TOT_1.TOT_PERC_TOTAL1 TOTAL_PERC_TOTAL1

         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO1,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL1
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES1
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO1
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_1
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES1
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO1
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES1,


      (SELECT RES.SEQ_CTS_RES_RESUMO_01,

              RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_2,
              TOT_PERC_DIR_TOT_2.TOT_PERC_DIRETO2 TOTAL_PERC_DIRETO2,

              RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_2,
              TOT_PERC_DIR_TOT_2.TOT_PERC_TOTAL2 TOTAL_PERC_TOTAL2
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO2,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL2
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES2
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO2
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_2
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES2
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO2
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES2,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_3,
                TOT_PERC_DIR_TOT_3.TOT_PERC_DIRETO3 TOTAL_PERC_DIRETO3,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_3,
                TOT_PERC_DIR_TOT_3.TOT_PERC_TOTAL3 TOTAL_PERC_TOTAL3
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO3,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL3
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES3
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO3
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_3
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES3
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO3
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES3,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_4,
                TOT_PERC_DIR_TOT_4.TOT_PERC_DIRETO4 TOTAL_PERC_DIRETO4,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_4,
                TOT_PERC_DIR_TOT_4.TOT_PERC_TOTAL4 TOTAL_PERC_TOTAL4
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO4,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL4
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES4
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO4
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_4
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES4
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO4
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES4,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_5,
                TOT_PERC_DIR_TOT_5.TOT_PERC_DIRETO5 TOTAL_PERC_DIRETO5,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_5,
                TOT_PERC_DIR_TOT_5.TOT_PERC_TOTAL5 TOTAL_PERC_TOTAL5
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO5,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL5
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES5
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO5
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_5
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES5
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO5
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES5,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_6,
                TOT_PERC_DIR_TOT_6.TOT_PERC_DIRETO6 TOTAL_PERC_DIRETO6,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_6,
                TOT_PERC_DIR_TOT_6.TOT_PERC_TOTAL6 TOTAL_PERC_TOTAL6
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO6,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL6
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES6
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO6
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_6
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES6
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO6
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES6,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_7,
                TOT_PERC_DIR_TOT_7.TOT_PERC_DIRETO7 TOTAL_PERC_DIRETO7,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_7,
                TOT_PERC_DIR_TOT_7.TOT_PERC_TOTAL7 TOTAL_PERC_TOTAL7


         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO7,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL7
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES7
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO7
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_7
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES7
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO7
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES7,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_8,
                TOT_PERC_DIR_TOT_8.TOT_PERC_DIRETO8 TOTAL_PERC_DIRETO8,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_8,
                TOT_PERC_DIR_TOT_8.TOT_PERC_TOTAL8 TOTAL_PERC_TOTAL8
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO8,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL8
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES8
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO8
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_8
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES8
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO8
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES8,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_9,
                TOT_PERC_DIR_TOT_9.TOT_PERC_DIRETO9 TOTAL_PERC_DIRETO9,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_9,
                TOT_PERC_DIR_TOT_9.TOT_PERC_TOTAL9 TOTAL_PERC_TOTAL9
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO9,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL9
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES9
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO9
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_9
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES9
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO9
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES9,


        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_10,
                TOT_PERC_DIR_TOT_10.TOT_PERC_DIRETO10 TOTAL_PERC_DIRETO10,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_10,
                TOT_PERC_DIR_TOT_10.TOT_PERC_TOTAL10 TOTAL_PERC_TOTAL10
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO10,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL10
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES10
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO10
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_10
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES10
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO10
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES10,

        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_11,
                TOT_PERC_DIR_TOT_11.TOT_PERC_DIRETO11 TOTAL_PERC_DIRETO11,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_11,
                TOT_PERC_DIR_TOT_11.TOT_PERC_TOTAL11 TOTAL_PERC_TOTAL11
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO11,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL11
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES11
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO11
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_11
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES11
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO11
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES11,

        (SELECT RES.SEQ_CTS_RES_RESUMO_01,

                RES.CTS_RES_RESU_PC_DIRETO PERC_DIRETO_12,
                TOT_PERC_DIR_TOT_12.TOT_PERC_DIRETO12 TOTAL_PERC_DIRETO12,

                RES.CTS_RES_RESU_PC_TOTAL PERC_TOTAL_12,
                TOT_PERC_DIR_TOT_12.TOT_PERC_TOTAL12 TOTAL_PERC_TOTAL12
         FROM TB_CTS_RES_RESUMO_GERAL RES, (SELECT ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI)) /
                                                       	 (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI)) - 1, 4) TOT_PERC_DIRETO12,
                                                   ROUND((SUM(RES.CTS_RES_RESU_VL_REC_DIRETA) + SUM(RES.CTS_RES_RESU_VL_REC_INTERMEDI) + SUM(RES.CTS_RES_RESU_VL_REC_INDIRETA)) /
                                                         (SUM(RES.CTS_RES_RESU_VL_DESP_DIRETA) + SUM(RES.CTS_RES_RESU_VL_DESP_INTERMEDI) + SUM(CTS_RES_RESU_VL_DESP_INDIRETA)) - 1, 4) TOT_PERC_TOTAL12
                                              FROM TB_CTS_RES_RESUMO_GERAL RES
                                             WHERE RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL = 2
                                               AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES12
                                               AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO12
                                               AND RES.CTS_RES_RESU_TIPO = 'R'
                                               AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1 ) TOT_PERC_DIR_TOT_12
        WHERE RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES12
          AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO12
          AND RES.CTS_RES_RESU_TIPO = 'R'
          AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
        ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA) MES12

     WHERE RES.CTS_RES_RESU_TIPO = 'R'
       AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES1.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES2.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES3.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES4.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES5.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES6.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES7.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES8.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES9.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES10.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES11.SEQ_CTS_RES_RESUMO_01(+)
       AND RES.SEQ_CTS_RES_RESUMO_01 = MES12.SEQ_CTS_RES_RESUMO_01(+)
       
       AND (RES.CTS_RES_RESU_ANO||LPAD(RES.CTS_RES_RESU_MES,2,'0') BETWEEN v_AnoMesFim AND v_AnoMesInicio)

     GROUP BY RES.CTS_RES_RESU_TIPO,
              RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL,
              RES.CTS_RES_RESU_CAD_CTS_DS_DESCRI,
              RES.CTS_RES_RESU_CAD_CTS_CD_CONTA
     ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA;
     
    IO_CURSOR := V_CURSOR;
 END PRC_CTS_REL_03;
