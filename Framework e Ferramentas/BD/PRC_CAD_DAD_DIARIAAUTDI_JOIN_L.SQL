create or replace procedure PRC_CAD_DAD_DIARIAAUTDI_JOIN_L
  (
     pCAD_DAD_ID IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_DAD_ID%type DEFAULT NULL,
     pCAD_CNV_ID_CONVENIO IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_CNV_ID_CONVENIO%type DEFAULT NULL,
     pCAD_CNV_ID_CONVENIO_DES IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_CNV_ID_CONVENIO_DES%type DEFAULT NULL,
     pCAD_PLA_ID_PLANO IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_PLA_ID_PLANO%type DEFAULT NULL,
     pCAD_SPL_ID IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_SPL_ID%type DEFAULT NULL,
     pTIS_TAC_CD_TIPO_ACOMOD_ORI IN TB_CAD_DAD_DIARIA_AUTDIFCNV.TIS_TAC_CD_TIPO_ACOMOD_ORI%type DEFAULT NULL,
     pCAD_PRD_ID_ORI IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_PRD_ID_ORI%type DEFAULT NULL,
     pTIS_TAC_CD_TIPO_ACOMOD_DES IN TB_CAD_DAD_DIARIA_AUTDIFCNV.TIS_TAC_CD_TIPO_ACOMOD_DES%type DEFAULT NULL,
     pCAD_PRD_ID_DES IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_PRD_ID_DES%type DEFAULT NULL,
     pCAD_SET_ID IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_SET_ID%type DEFAULT NULL,
     pCAD_DAD_DT_INICIO_VIGENCIA IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_DAD_DT_INICIO_VIGENCIA%type DEFAULT NULL,
     pCAD_DAD_DT_FIM_VIGENCIA IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_DAD_DT_FIM_VIGENCIA%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO IN TB_CAD_DAD_DIARIA_AUTDIFCNV.SEG_USU_ID_USUARIO%type DEFAULT NULL,
     pCAD_DAD_DT_ULTIMA_ATUALIZACAO IN TB_CAD_DAD_DIARIA_AUTDIFCNV.CAD_DAD_DT_ULTIMA_ATUALIZACAO%type DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor
  )
  is
  /********************************************************************
  *    Procedure: PRC_CAD_DAD_DIARIAAUTDI_JOIN_L
  *
  *    Data Criacao:   05/10   Por: André S. Monaco
  *
  *    Funcao: Listar diárias de diferença de classe / cortesia
  *
  *******************************************************************/
  v_cursor PKG_CURSOR.t_cursor;
  begin
    OPEN v_cursor FOR
    SELECT  
       DAD.CAD_DAD_ID,
       DAD.CAD_CNV_ID_CONVENIO,
       DAD.CAD_CNV_ID_CONVENIO_DES,
       DAD.CAD_PLA_ID_PLANO,
       DAD.CAD_SPL_ID,
       DAD.TIS_TAC_CD_TIPO_ACOMOD_ORI,
       DAD.CAD_PRD_ID_ORI,
       DAD.TIS_TAC_CD_TIPO_ACOMOD_DES,
       DAD.CAD_PRD_ID_DES,
       DAD.CAD_SET_ID,
       DAD.CAD_DAD_DT_INICIO_VIGENCIA,
       DAD.CAD_DAD_DT_FIM_VIGENCIA,
       DAD.SEG_USU_ID_USUARIO,
       DAD.CAD_DAD_DT_ULTIMA_ATUALIZACAO,
       DAD.CAD_DAD_FL_CONSIDERAOBITO,
       DAD.CAD_DAD_HR_OBITO_MAIOR,
       
       PRD_ORIGEM.CAD_PRD_CD_CODIGO  CODIGO_ORIGEM,
       PRD_DESTINO.CAD_PRD_CD_CODIGO CODIGO_DESTINO,
       
       PRD_ORIGEM.CAD_PRD_DS_DESCRICAO  PRODUTO_ORIGEM,
       PRD_DESTINO.CAD_PRD_DS_DESCRICAO PRODUTO_DESTINO,
       
       TAC_ORIGEM.TIS_TAC_DS_TIPO_ACOMODACAO  TIPO_ACOMODACAO_ORIGEM,
       TAC_DESTINO.TIS_TAC_DS_TIPO_ACOMODACAO TIPO_ACOMODACAO_DESTINO,
       
       SPL.CAD_SPL_DS_SUB_PLANO,
       UNI.CAD_UNI_DS_UNIDADE,
       SETOR.CAD_SET_DS_SETOR,
       CNV_ORIGEM.CAD_CNV_CD_HAC_PRESTADOR,
       PLA.CAD_PLA_CD_PLANO,
       CNV_DESTINO.CAD_CNV_CD_HAC_PRESTADOR DS_CNV_DESTINO
       
    FROM TB_CAD_DAD_DIARIA_AUTDIFCNV DAD,
         TB_CAD_PRD_PRODUTO          PRD_ORIGEM,
         TB_CAD_PRD_PRODUTO          PRD_DESTINO,
         TB_CAD_SET_SETOR            SETOR,
         TB_TIS_TAC_TIPO_ACOMODACAO  TAC_ORIGEM,
         TB_TIS_TAC_TIPO_ACOMODACAO  TAC_DESTINO,
         TB_CAD_SPL_SUB_PLANO        SPL,
         TB_CAD_CNV_CONVENIO         CNV_ORIGEM,
         TB_CAD_CNV_CONVENIO         CNV_DESTINO,
         TB_CAD_PLA_PLANO            PLA,
         TB_CAD_UNI_UNIDADE UNI
    WHERE
        (pCAD_DAD_ID is null OR DAD.CAD_DAD_ID = pCAD_DAD_ID) AND
        (pCAD_CNV_ID_CONVENIO is null OR DAD.CAD_CNV_ID_CONVENIO = pCAD_CNV_ID_CONVENIO) AND
        (pCAD_CNV_ID_CONVENIO_DES is null OR DAD.CAD_CNV_ID_CONVENIO_DES = pCAD_CNV_ID_CONVENIO_DES) AND
        (pCAD_PLA_ID_PLANO is null OR DAD.CAD_PLA_ID_PLANO = pCAD_PLA_ID_PLANO) AND
        (pCAD_SPL_ID is null OR DAD.CAD_SPL_ID = pCAD_SPL_ID) AND
        (pTIS_TAC_CD_TIPO_ACOMOD_ORI is null OR DAD.TIS_TAC_CD_TIPO_ACOMOD_ORI = pTIS_TAC_CD_TIPO_ACOMOD_ORI) AND
        (pCAD_PRD_ID_ORI is null OR DAD.CAD_PRD_ID_ORI = pCAD_PRD_ID_ORI) AND
        (pTIS_TAC_CD_TIPO_ACOMOD_DES is null OR DAD.TIS_TAC_CD_TIPO_ACOMOD_DES = pTIS_TAC_CD_TIPO_ACOMOD_DES) AND
        (pCAD_PRD_ID_DES is null OR DAD.CAD_PRD_ID_DES = pCAD_PRD_ID_DES) AND
        (pCAD_SET_ID is null OR DAD.CAD_SET_ID = pCAD_SET_ID) AND
        (pCAD_DAD_DT_INICIO_VIGENCIA is null OR DAD.CAD_DAD_DT_INICIO_VIGENCIA = pCAD_DAD_DT_INICIO_VIGENCIA) AND
        (pCAD_DAD_DT_FIM_VIGENCIA is null OR DAD.CAD_DAD_DT_FIM_VIGENCIA = pCAD_DAD_DT_FIM_VIGENCIA) AND
        (pSEG_USU_ID_USUARIO is null OR DAD.SEG_USU_ID_USUARIO = pSEG_USU_ID_USUARIO) AND
        (pCAD_DAD_DT_ULTIMA_ATUALIZACAO is null OR DAD.CAD_DAD_DT_ULTIMA_ATUALIZACAO = pCAD_DAD_DT_ULTIMA_ATUALIZACAO) AND
        (DAD.CAD_PRD_ID_ORI = PRD_ORIGEM.CAD_PRD_ID(+)) AND 
        (DAD.CAD_PRD_ID_DES = PRD_DESTINO.CAD_PRD_ID(+)) AND 
        (DAD.CAD_SET_ID = SETOR.CAD_SET_ID(+)) AND 
        (DAD.TIS_TAC_CD_TIPO_ACOMOD_ORI = TAC_ORIGEM.TIS_TAC_CD_TIPO_ACOMODACAO(+)) AND 
        (DAD.TIS_TAC_CD_TIPO_ACOMOD_DES = TAC_DESTINO.TIS_TAC_CD_TIPO_ACOMODACAO(+)) AND 
        (DAD.CAD_SPL_ID = SPL.CAD_SPL_ID(+)) AND
        (CNV_ORIGEM.CAD_CNV_ID_CONVENIO = DAD.CAD_CNV_ID_CONVENIO) AND
        (CNV_DESTINO.CAD_CNV_ID_CONVENIO = DAD.CAD_CNV_ID_CONVENIO_DES) AND
        (PLA.CAD_PLA_ID_PLANO (+)= DAD.CAD_PLA_ID_PLANO) AND
        (SETOR.CAD_UNI_ID_UNIDADE = UNI.CAD_UNI_ID_UNIDADE);
    io_cursor := v_cursor;
  end PRC_CAD_DAD_DIARIAAUTDI_JOIN_L;
