CREATE OR REPLACE PROCEDURE "PRC_CTS_REL_09"
  (
     pCTS_RES_RESU_MES1       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO1       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES2       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO2       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES3       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO3       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES4       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO4       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES5       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO5       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES6       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO6       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES7       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO7       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES8       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO8       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES9       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO9       IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES10      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO10      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES11      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO11      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     pCTS_RES_RESU_MES12      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_MES_PAGTO%type,
     pCTS_RES_RESU_ANO12      IN TB_REP_RPA_RESUMO_PAGTO.REP_RPA_ANO_PAGTO%type,
     IO_CURSOR                OUT PKG_CURSOR.T_CURSOR
  )
  IS
  v_cursor PKG_CURSOR.t_cursor;
  v_AnoMesInicio NUMBER;
  v_AnoMesFim    NUMBER;

BEGIN
  v_AnoMesInicio := pCTS_RES_RESU_ANO12||LPAD(pCTS_RES_RESU_MES12,2,'0');
  v_AnoMesFim    := pCTS_RES_RESU_ANO1||LPAD(pCTS_RES_RESU_MES1,2,'0');

  OPEN v_cursor FOR
    SELECT RES.CTS_RES_RESU_TIPO          TIPO,
           RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL  NIVEL,
           RES.CTS_RES_RESU_CAD_CTS_DS_DESCRI DESCRICAO,
           RES.CTS_RES_RESU_CAD_CTS_CD_CONTA  CONTA,

           SUM(MES1.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO1,
           SUM(MES1.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL1,
           SUM(MES2.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO2,
           SUM(MES2.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL2,
           SUM(MES3.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO3,
           SUM(MES3.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL3,
           SUM(MES4.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO4,
           SUM(MES4.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL4,
           SUM(MES5.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO5,
           SUM(MES5.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL5,
           SUM(MES6.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO6,
           SUM(MES6.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL6,
           SUM(MES7.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO7,
           SUM(MES7.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL7,
           SUM(MES8.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO8,
           SUM(MES8.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL8,
           SUM(MES9.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO9,
           SUM(MES9.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL9,
           SUM(MES10.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO10,
           SUM(MES10.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL10,
           SUM(MES11.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO11,
           SUM(MES11.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL11,
           SUM(MES12.PERCENTUAL_DIRETO) PERCENTUAL_DIRETO12,
           SUM(MES12.PERCENTUAL_TOTAL) PERCENTUAL_TOTAL12

      FROM TB_CTS_RES_RESUMO_GERAL RES,

      -- MES 1
      ( SELECT SEQ_CTS_RES_RESUMO_01,
               (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                  ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
               (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                  ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                              (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
          FROM TB_CTS_RES_RESUMO_GERAL RES
         WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
           AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
           AND RES.CTS_RES_RESU_TIPO = 'D'
           AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES1
           AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO1
           ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES1,

      -- MES 2
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES2
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO2
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES2,

     -- MES 3
     ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES3
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO3
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES3,

      -- MES 4
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES4
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO4
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES4,

      -- MES 5
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES5
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO5
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES5,

      -- MES 6
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES6
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO6
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES6,

      -- MES 7
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES7
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO7
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES7,

      --MES8
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES8
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO8
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES8,

      -- MES 9
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES9
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO9
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES9,

      -- MES 10
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES10
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO10
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES10,

      -- MES 11
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES11
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO11
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES11,

      -- MES 12
      ( SELECT SEQ_CTS_RES_RESUMO_01,
             (CASE WHEN CTS_RES_RESU_VL_DESP_DIRETA  = 0 THEN 0
                ELSE ROUND(RES.CTS_RES_RESU_VL_REC_DIRETA / RES.CTS_RES_RESU_VL_DESP_DIRETA, 4) - 1 END) PERCENTUAL_DIRETO,
             (CASE WHEN (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA) = 0 THEN 0
                ELSE ROUND(((RES.CTS_RES_RESU_VL_REC_DIRETA + RES.CTS_RES_RESU_VL_REC_INDIRETA) /
                            (RES.CTS_RES_RESU_VL_DESP_DIRETA + RES.CTS_RES_RESU_VL_DESP_INDIRETA)), 4) - 1 END) PERCENTUAL_TOTAL
        FROM TB_CTS_RES_RESUMO_GERAL RES
       WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
         AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
         AND RES.CTS_RES_RESU_TIPO = 'D'
         AND RES.CTS_RES_RESU_MES = pCTS_RES_RESU_MES12
         AND RES.CTS_RES_RESU_ANO = pCTS_RES_RESU_ANO12
         ORDER BY RES.CTS_RES_RESU_TIPO, CTS_RES_RESU_CAD_CTS_CD_CONTA ) MES12

 WHERE RES.CTS_RES_RESU_CAD_CTS_CD_CONTA != 1
   AND RES.CTS_RES_RESU_CAD_CTS_CD_CONTA LIKE '130%'
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES1.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES2.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES3.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES4.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES5.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES6.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES7.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES8.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES9.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES10.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES11.SEQ_CTS_RES_RESUMO_01(+)
   AND RES.SEQ_CTS_RES_RESUMO_01 = MES12.SEQ_CTS_RES_RESUMO_01(+)
   AND (RES.CTS_RES_RESU_ANO||LPAD(RES.CTS_RES_RESU_MES,2,'0') BETWEEN v_AnoMesFim AND v_AnoMesInicio)

GROUP BY RES.CTS_RES_RESU_TIPO,
         RES.CTS_RES_RESU_CAD_CTS_CD_NIVEL,
         RES.CTS_RES_RESU_CAD_CTS_DS_DESCRI,
         RES.CTS_RES_RESU_CAD_CTS_CD_CONTA
 ORDER BY TIPO, CONTA;
    IO_CURSOR := V_CURSOR;
 END PRC_CTS_REL_09;
