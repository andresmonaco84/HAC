 create or replace procedure PRC_CAD_PROF_PAG
(
     pCAD_PRO_NR_CONSELHO     IN TB_CAD_PRO_PROFISSIONAL.CAD_PRO_NR_CONSELHO%type default null,
     pCAD_PRO_SG_UF_CONSELHO  IN TB_CAD_PRO_PROFISSIONAL.CAD_PRO_SG_UF_CONSELHO%type,
     pTIS_CPR_CD_CONSELHOPROF IN TB_CAD_PRO_PROFISSIONAL.TIS_CPR_CD_CONSELHOPROF%type,          
     pCAD_PRO_NM_NOME         IN TB_CAD_PRO_PROFISSIONAL.CAD_PRO_NM_NOME%type default null, 
     pINICIO                  IN NUMBER,         
     io_cursor OUT PKG_CURSOR.t_cursor
)
is

v_cursor PKG_CURSOR.t_cursor;
begin
OPEN v_cursor FOR

SELECT * FROM (SELECT a.*, rownum rnum FROM (
    SELECT PRO.CAD_PRO_NR_CONSELHO,
           PRO.CAD_PRO_SG_UF_CONSELHO,
           PRO.TIS_CPR_CD_CONSELHOPROF,
           PRO.CAD_PRO_NM_NOME,
           PRO.CAD_PRO_ID_PROFISSIONAL
    FROM TB_CAD_PRO_PROFISSIONAL PRO
    WHERE  PRO.CAD_PRO_SG_UF_CONSELHO = pCAD_PRO_SG_UF_CONSELHO
    AND    PRO.TIS_CPR_CD_CONSELHOPROF = pTIS_CPR_CD_CONSELHOPROF
    AND    (pCAD_PRO_NR_CONSELHO IS NULL OR trim(upper(pCAD_PRO_NR_CONSELHO)) = upper(PRO.CAD_PRO_NR_CONSELHO))
    AND    (pCAD_PRO_NM_NOME IS NULL OR upper(PRO.CAD_PRO_NM_NOME) LIKE '%'|| upper(trim(pCAD_PRO_NM_NOME)) ||'%')
    ORDER BY PRO.CAD_PRO_NM_NOME
       
) a 
WHERE rownum <= (pINICIO+10)) WHERE rnum >= pINICIO;   

io_cursor := v_cursor;
end PRC_CAD_PROF_PAG;
