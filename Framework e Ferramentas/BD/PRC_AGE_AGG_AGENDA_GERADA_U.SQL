CREATE OR REPLACE PROCEDURE "PRC_AGE_AGG_AGENDA_GERADA_U"
  (
     pAGE_AGG_ID IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_ID%type,
     pAGE_ESM_ID IN TB_AGE_AGG_AGENDA_GERADA.AGE_ESM_ID%type,
     pAGE_ESF_ID IN TB_AGE_AGG_AGENDA_GERADA.AGE_ESF_ID%type default NULL,
     pAGE_AGG_DT_AGENDA IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_DT_AGENDA%type,
     pAGE_AGG_HR_AGENDA IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_HR_AGENDA%type,
     pAGE_AGG_TP_HORARIO IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_TP_HORARIO%type,
     pSEG_USU_ID_USUARIO IN TB_AGE_AGG_AGENDA_GERADA.SEG_USU_ID_USUARIO%type,
     pAGE_AGG_FL_STATUS_HORARIO IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_FL_STATUS_HORARIO%type,
     pAGE_AGG_DS_BLOQUEIO IN TB_AGE_AGG_AGENDA_GERADA.AGE_AGG_DS_BLOQUEIO%type DEFAULT NULL
  )
  is
  /********************************************************************
  *    Procedure: PRC_AGE_AGG_AGENDA_GERADA_U
  *
  *    Data Alteracao: 14/10/2013 POR: PEDRO
  *    Alterac?o: pAGE_AGG_DS_BLOQUEIO
  *
  *******************************************************************/
  sTipoHorario char(1);
  begin
  SELECT AGE_AGG_TP_HORARIO INTO sTipoHorario FROM TB_AGE_AGG_AGENDA_GERADA AGG WHERE AGG.AGE_AGG_ID = pAGE_AGG_ID;

    UPDATE TB_AGE_AGG_AGENDA_GERADA
    SET
        AGE_ESM_ID = pAGE_ESM_ID,
        AGE_ESF_ID = pAGE_ESF_ID,
        AGE_AGG_DT_AGENDA = pAGE_AGG_DT_AGENDA,
        AGE_AGG_HR_AGENDA = pAGE_AGG_HR_AGENDA,
        AGE_AGG_TP_HORARIO = DECODE(sTipoHorario,5,5,pAGE_AGG_TP_HORARIO),
        SEG_USU_ID_USUARIO = pSEG_USU_ID_USUARIO,
        AGE_AGG_FL_STATUS_HORARIO = pAGE_AGG_FL_STATUS_HORARIO,
        AGE_AGG_DS_BLOQUEIO = pAGE_AGG_DS_BLOQUEIO,
        AGE_AGG_DT_ULTIMA_ATUALIZACAO = SYSDATE
    WHERE
        AGE_AGG_ID = pAGE_AGG_ID;


  end PRC_AGE_AGG_AGENDA_GERADA_U;
 