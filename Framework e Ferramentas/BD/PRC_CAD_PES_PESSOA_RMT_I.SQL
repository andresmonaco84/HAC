CREATE OR REPLACE PROCEDURE "PRC_CAD_PES_PESSOA_RMT_I"
  (
     pNewIdt OUT integer,
     pCAD_PES_ID_PESSOA IN TB_CAD_PES_PESSOA.CAD_PES_ID_PESSOA%type,
     pCAD_PES_NR_CNPJ_CPF IN TB_CAD_PES_PESSOA.CAD_PES_NR_CNPJ_CPF%type default NULL,
     pCAD_PES_FL_JURIDICA_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_JURIDICA_OK%type,
     pCAD_PES_NM_PESSOA IN TB_CAD_PES_PESSOA.CAD_PES_NM_PESSOA%type,
     pCAD_PES_DT_ULTIMA_ATUALIZACAO IN TB_CAD_PES_PESSOA.CAD_PES_DT_ULTIMA_ATUALIZACAO%type,
     pSEG_USU_ID_USUARIO IN TB_CAD_PES_PESSOA.SEG_USU_ID_USUARIO%type,
     pCAD_PES_DT_NASCIMENTO IN TB_CAD_PES_PESSOA.CAD_PES_DT_NASCIMENTO%type default NULL,
     pCAD_PES_NR_RG IN TB_CAD_PES_PESSOA.CAD_PES_NR_RG%type default NULL,
     pCAD_PES_NM_RAZAOSOCIAL IN TB_CAD_PES_PESSOA.CAD_PES_NM_RAZAOSOCIAL%type default NULL,
     pCAD_PES_CD_INSCR_ESTAD IN TB_CAD_PES_PESSOA.CAD_PES_CD_INSCR_ESTAD%type default NULL,
     pCAD_PES_CD_INSCR_MUNIC IN TB_CAD_PES_PESSOA.CAD_PES_CD_INSCR_MUNIC%type default NULL,
     pCAD_PES_TP_SEXO IN TB_CAD_PES_PESSOA.CAD_PES_TP_SEXO%type default NULL,
     pCAD_PES_CD_ESTADOCIVIL IN TB_CAD_PES_PESSOA.CAD_PES_CD_ESTADOCIVIL%type default NULL,
     pCAD_PES_NM_NOMEMAE IN TB_CAD_PES_PESSOA.CAD_PES_NM_NOMEMAE%type default NULL,
     pCAD_PES_CD_ORGAOEMISSORRG IN TB_CAD_PES_PESSOA.CAD_PES_CD_ORGAOEMISSORRG%type default NULL,
     pCAD_PES_DT_EXPEDICAORG IN TB_CAD_PES_PESSOA.CAD_PES_DT_EXPEDICAORG%type default NULL,
     pCAD_PES_TP_SANGUINEO IN TB_CAD_PES_PESSOA.CAD_PES_TP_SANGUINEO%type default NULL,
     pCAD_PES_FL_SANGPOSITIVO_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_SANGPOSITIVO_OK%type default NULL,
     pAUX_PRF_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_PRF_CD_CODIGO%type default NULL,
     pAUX_NAC_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_NAC_CD_CODIGO%type default NULL,
     pCAD_PES_FL_DOADORORGAOS_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_DOADORORGAOS_OK%type default NULL,
     pCAD_PES_NM_NATURALIDADE IN TB_CAD_PES_PESSOA.CAD_PES_NM_NATURALIDADE%type default NULL,
     pAUX_ESC_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_ESC_CD_CODIGO%type default NULL,
     pCAD_PES_NM_NOMEPAI IN TB_CAD_PES_PESSOA.CAD_PES_NM_NOMEPAI%type default NULL,
     pCAD_PES_NM_CONJUGE IN TB_CAD_PES_PESSOA.CAD_PES_NM_CONJUGE%type default NULL,
     pAUX_UFE_SG_UF IN TB_CAD_PES_PESSOA.AUX_UFE_SG_UF%type default NULL,
     pCODCFO IN TB_CAD_PES_PESSOA.CODCFO%type DEFAULT NULL,
     pCAD_PES_CD_CNS_SUS IN TB_CAD_PES_PESSOA.CAD_PES_CD_CNS_SUS%TYPE DEFAULT NULL,
     pCAD_PES_NOME_SOUNDEX IN TB_CAD_PES_PESSOA.CAD_PES_NOME_SOUNDEX%type default NULL,
     pCAD_PES_FL_ATIVO_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_ATIVO_OK%type default 'S',
     pCAD_PES_NM_RN IN TB_CAD_PES_PESSOA.CAD_PES_NM_RN%type default NULL,
     pCAD_PES_DT_NASC_RN IN DATE default NULL,
     pCAD_PES_TP_SEXO_RN IN TB_CAD_PES_PESSOA.CAD_PES_TP_SEXO_RN%type default NULL,
     pCAD_PES_FL_PRE_ATENDIMENTO IN TB_CAD_PES_PESSOA.CAD_PES_FL_PRE_ATENDIMENTO%type DEFAULT NULL,
     pCAD_PES_FL_EMAIL_INFORMADO IN TB_CAD_PES_PESSOA.CAD_PES_FL_EMAIL_INFORMADO%type DEFAULT NULL,
     pCAD_PES_DT_DESBLOQUEIO_CPF IN TB_CAD_PES_PESSOA.CAD_PES_DT_DESBLOQUEIO_CPF%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO_DESB_CPF IN TB_CAD_PES_PESSOA.SEG_USU_ID_USUARIO_DESB_CPF%type DEFAULT NULL,
     pCAD_PES_FL_CUIDADOINTEGRAL IN TB_CAD_PES_PESSOA.CAD_PES_FL_CUIDADOINTEGRAL%type DEFAULT NULL,
     pCAD_PES_FL_ISOLAMENTO IN TB_CAD_PES_PESSOA.CAD_PES_FL_ISOLAMENTO%type DEFAULT NULL
  )
  is
  /********************************************************************
  *    Procedure: PRC_CAD_PES_PESSOA_RMT_I
  *
 *    Data Alteracao:  05/01/2012  Por: Pedro
  *    Alteracao: Adic?o doS campoS pCODCFO pCAD_PES_CD_CNS_SUS
  *
  *    Funcao: Descri???#o da funcionalidade da Stored Procedure
  *
  *******************************************************************/
  lIdtRetorno integer;
  estadoCivil VARCHAR2(2);
  BEGIN
  IF pCAD_PES_CD_ESTADOCIVIL not in (1,2,3,4,5,6) THEN
  CASE
   WHEN pCAD_PES_CD_ESTADOCIVIL = 'S' THEN
      estadoCivil := '1';
   WHEN pCAD_PES_CD_ESTADOCIVIL = 'C' THEN
      estadoCivil := '2';
   WHEN pCAD_PES_CD_ESTADOCIVIL = 'D' THEN
      estadoCivil := '4';
   WHEN pCAD_PES_CD_ESTADOCIVIL = 'V' THEN
      estadoCivil := '5';
   WHEN pCAD_PES_CD_ESTADOCIVIL = 'U' THEN
      estadoCivil := '6';
   ELSE estadoCivil := NULL;
  END CASE;
  ELSE  estadoCivil := pCAD_PES_CD_ESTADOCIVIL;
  END IF;
  SELECT SEQ_CAD_PES_01.NextVal INTO lIdtRetorno FROM DUAL;
    INSERT INTO TB_CAD_PES_PESSOA
    (
       CAD_PES_ID_PESSOA,
       CAD_PES_NR_CNPJ_CPF,
       CAD_PES_FL_JURIDICA_OK,
       CAD_PES_NM_PESSOA,
       CAD_PES_DT_ULTIMA_ATUALIZACAO,
       SEG_USU_ID_USUARIO,
       CAD_PES_DT_NASCIMENTO,
       CAD_PES_NR_RG,
       CAD_PES_NM_RAZAOSOCIAL,
       CAD_PES_CD_INSCR_ESTAD,
       CAD_PES_CD_INSCR_MUNIC,
       CAD_PES_TP_SEXO,
       CAD_PES_CD_ESTADOCIVIL,
       CAD_PES_NM_NOMEMAE,
       CAD_PES_CD_ORGAOEMISSORRG,
       CAD_PES_DT_EXPEDICAORG,
       CAD_PES_TP_SANGUINEO,
       CAD_PES_FL_SANGPOSITIVO_OK,
       AUX_PRF_CD_CODIGO,
       AUX_NAC_CD_CODIGO,
       CAD_PES_FL_DOADORORGAOS_OK,
       CAD_PES_NM_NATURALIDADE,
       AUX_ESC_CD_CODIGO,
       CAD_PES_NM_NOMEPAI,
       CAD_PES_NM_CONJUGE,
       AUX_UFE_SG_UF,
       CODCFO,
       CAD_PES_CD_CNS_SUS,
       CAD_PES_NOME_SOUNDEX,
       CAD_PES_NM_RN,
       CAD_PES_DT_NASC_RN,
       CAD_PES_TP_SEXO_RN,
       CAD_PES_FL_PRE_ATENDIMENTO,
       CAD_PES_FL_EMAIL_INFORMADO,
       CAD_PES_DT_DESBLOQUEIO_CPF,
       SEG_USU_ID_USUARIO_DESB_CPF,
       CAD_PES_FL_CUIDADOINTEGRAL,
       CAD_PES_FL_ISOLAMENTO
    )
    VALUES
    (
       lIdtRetorno,
       pCAD_PES_NR_CNPJ_CPF,
       pCAD_PES_FL_JURIDICA_OK,
       pCAD_PES_NM_PESSOA,
       pCAD_PES_DT_ULTIMA_ATUALIZACAO,
       pSEG_USU_ID_USUARIO,
       TRUNC(pCAD_PES_DT_NASCIMENTO),
       pCAD_PES_NR_RG,
       pCAD_PES_NM_RAZAOSOCIAL,
       pCAD_PES_CD_INSCR_ESTAD,
       pCAD_PES_CD_INSCR_MUNIC,
       pCAD_PES_TP_SEXO,
       estadoCivil,
       pCAD_PES_NM_NOMEMAE,
       pCAD_PES_CD_ORGAOEMISSORRG,
       pCAD_PES_DT_EXPEDICAORG,
       pCAD_PES_TP_SANGUINEO,
       pCAD_PES_FL_SANGPOSITIVO_OK,
       pAUX_PRF_CD_CODIGO,
       pAUX_NAC_CD_CODIGO,
       pCAD_PES_FL_DOADORORGAOS_OK,
       pCAD_PES_NM_NATURALIDADE,
       pAUX_ESC_CD_CODIGO,
       pCAD_PES_NM_NOMEPAI,
       pCAD_PES_NM_CONJUGE,
       pAUX_UFE_SG_UF,
       pCODCFO,
       pCAD_PES_CD_CNS_SUS,
       FNC_PES_SOUNDEX_NOME(pCAD_PES_NM_PESSOA,' '),
       pCAD_PES_NM_RN,
	     pCAD_PES_DT_NASC_RN,
	     pCAD_PES_TP_SEXO_RN,
       pCAD_PES_FL_PRE_ATENDIMENTO,
       pCAD_PES_FL_EMAIL_INFORMADO,
       pCAD_PES_DT_DESBLOQUEIO_CPF,
       pSEG_USU_ID_USUARIO_DESB_CPF,
       pCAD_PES_FL_CUIDADOINTEGRAL,
       pCAD_PES_FL_ISOLAMENTO
    );
    pNewIdt := lIdtRetorno;
  end PRC_CAD_PES_PESSOA_RMT_I;
