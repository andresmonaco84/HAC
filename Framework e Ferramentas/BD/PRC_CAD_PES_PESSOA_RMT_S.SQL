CREATE OR REPLACE PROCEDURE "PRC_CAD_PES_PESSOA_RMT_S"
  (
     pCAD_PES_ID_PESSOA IN TB_CAD_PES_PESSOA.CAD_PES_ID_PESSOA%type DEFAULT NULL,
     pCAD_PES_NR_CNPJ_CPF IN TB_CAD_PES_PESSOA.CAD_PES_NR_CNPJ_CPF%type DEFAULT NULL,
     pCAD_PES_FL_JURIDICA_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_JURIDICA_OK%type DEFAULT NULL,
     pCAD_PES_NM_PESSOA IN TB_CAD_PES_PESSOA.CAD_PES_NM_PESSOA%type DEFAULT NULL,
     pCAD_PES_DT_ULTIMA_ATUALIZACAO IN TB_CAD_PES_PESSOA.CAD_PES_DT_ULTIMA_ATUALIZACAO%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO IN TB_CAD_PES_PESSOA.SEG_USU_ID_USUARIO%type DEFAULT NULL,
     pCAD_PES_DT_NASCIMENTO IN TB_CAD_PES_PESSOA.CAD_PES_DT_NASCIMENTO%type DEFAULT NULL,
     pCAD_PES_NR_RG IN TB_CAD_PES_PESSOA.CAD_PES_NR_RG%type DEFAULT NULL,
     pCAD_PES_NM_RAZAOSOCIAL IN TB_CAD_PES_PESSOA.CAD_PES_NM_RAZAOSOCIAL%type DEFAULT NULL,
     pCAD_PES_CD_INSCR_ESTAD IN TB_CAD_PES_PESSOA.CAD_PES_CD_INSCR_ESTAD%type DEFAULT NULL,
     pCAD_PES_CD_INSCR_MUNIC IN TB_CAD_PES_PESSOA.CAD_PES_CD_INSCR_MUNIC%type DEFAULT NULL,
     pCAD_PES_TP_SEXO IN TB_CAD_PES_PESSOA.CAD_PES_TP_SEXO%type DEFAULT NULL,
     pCAD_PES_CD_ESTADOCIVIL IN TB_CAD_PES_PESSOA.CAD_PES_CD_ESTADOCIVIL%type DEFAULT NULL,
     pCAD_PES_NM_NOMEMAE IN TB_CAD_PES_PESSOA.CAD_PES_NM_NOMEMAE%type DEFAULT NULL,
     pCAD_PES_CD_ORGAOEMISSORRG IN TB_CAD_PES_PESSOA.CAD_PES_CD_ORGAOEMISSORRG%type DEFAULT NULL,
     pCAD_PES_DT_EXPEDICAORG IN TB_CAD_PES_PESSOA.CAD_PES_DT_EXPEDICAORG%type DEFAULT NULL,
     pCAD_PES_TP_SANGUINEO IN TB_CAD_PES_PESSOA.CAD_PES_TP_SANGUINEO%type DEFAULT NULL,
     pCAD_PES_FL_SANGPOSITIVO_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_SANGPOSITIVO_OK%type DEFAULT NULL,
     pAUX_PRF_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_PRF_CD_CODIGO%type DEFAULT NULL,
     pAUX_NAC_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_NAC_CD_CODIGO%type DEFAULT NULL,
     pCAD_PES_FL_DOADORORGAOS_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_DOADORORGAOS_OK%type DEFAULT NULL,
     pCAD_PES_NM_NATURALIDADE IN TB_CAD_PES_PESSOA.CAD_PES_NM_NATURALIDADE%type DEFAULT NULL,
     pAUX_ESC_CD_CODIGO IN TB_CAD_PES_PESSOA.AUX_ESC_CD_CODIGO%type DEFAULT NULL,
     pCAD_PES_NM_NOMEPAI IN TB_CAD_PES_PESSOA.CAD_PES_NM_NOMEPAI%type DEFAULT NULL,
     pCAD_PES_NM_CONJUGE IN TB_CAD_PES_PESSOA.CAD_PES_NM_CONJUGE%type DEFAULT NULL,
    -- pAUX_UFE_SG_UF IN TB_CAD_PES_PESSOA.AUX_UFE_SG_UF%type DEFAULT NULL,
     pCODCFO IN TB_CAD_PES_PESSOA.CODCFO%type DEFAULT NULL,
     pCAD_PES_NOME_SOUNDEX IN TB_CAD_PES_PESSOA.CAD_PES_NOME_SOUNDEX%type DEFAULT NULL,
     pCAD_PES_CD_CNS_SUS IN TB_CAD_PES_PESSOA.CAD_PES_CD_CNS_SUS%TYPE DEFAULT NULL,
     pCAD_PES_FL_ATIVO_OK IN TB_CAD_PES_PESSOA.CAD_PES_FL_ATIVO_OK%type DEFAULT NULL,
     pCAD_PES_NM_RN IN TB_CAD_PES_PESSOA.CAD_PES_NM_RN%type default NULL,
     pCAD_PES_DT_NASC_RN IN TB_CAD_PES_PESSOA.CAD_PES_DT_NASC_RN%type default NULL,
     pCAD_PES_TP_SEXO_RN IN TB_CAD_PES_PESSOA.CAD_PES_TP_SEXO_RN%type DEFAULT NULL,
     pCAD_PES_FL_PRE_ATENDIMENTO IN TB_CAD_PES_PESSOA.CAD_PES_FL_PRE_ATENDIMENTO%type DEFAULT NULL,
     pCAD_PES_FL_EMAIL_INFORMADO IN TB_CAD_PES_PESSOA.CAD_PES_FL_EMAIL_INFORMADO%type DEFAULT NULL,
     pCAD_PES_DT_DESBLOQUEIO_CPF IN TB_CAD_PES_PESSOA.CAD_PES_DT_DESBLOQUEIO_CPF%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO_DESB_CPF IN TB_CAD_PES_PESSOA.SEG_USU_ID_USUARIO_DESB_CPF%type DEFAULT NULL,
     pCAD_PES_FL_CUIDADOINTEGRAL IN TB_CAD_PES_PESSOA.CAD_PES_FL_CUIDADOINTEGRAL%type DEFAULT NULL,
     pCAD_PES_FL_ISOLAMENTO IN TB_CAD_PES_PESSOA.CAD_PES_FL_ISOLAMENTO%type DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor--,
     --TESTE OUT  LONG
)
is
/********************************************************************
*    Procedure: PRC_CAD_PES_PESSOA_L
*
*    Data Alteracao:  05/01/2012  Por: Pedro
*    Alteracao: Adic?o doS campoS pCODCFO pCAD_PES_CD_CNS_SUS
*
*    Funcao: Descric?o da funcionalidade da Stored Procedure
*
*******************************************************************/
 v_cursor PKG_CURSOR.t_cursor;
  V_WHERE  varchar2(5000);
  V_SELECT  varchar2(5000);
begin
  V_WHERE := NULL;
  IF pCAD_PES_ID_PESSOA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_ID_PESSOA = ' || pCAD_PES_ID_PESSOA; END IF;
IF pCAD_PES_NR_CNPJ_CPF IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NR_CNPJ_CPF = ' || pCAD_PES_NR_CNPJ_CPF; END IF;
IF pCAD_PES_FL_JURIDICA_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_JURIDICA_OK = ' || CHR(39) || pCAD_PES_FL_JURIDICA_OK || CHR(39); END IF;
IF pCAD_PES_NM_PESSOA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_PESSOA LIKE ' || CHR(39) || '%' || replace(pCAD_PES_NM_PESSOA,CHR(39),' ') || '%' || CHR(39); END IF;
IF pCAD_PES_DT_ULTIMA_ATUALIZACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_DT_ULTIMA_ATUALIZACAO = ' || CHR(39) || pCAD_PES_DT_ULTIMA_ATUALIZACAO || CHR(39); END IF;
IF pSEG_USU_ID_USUARIO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND SEG_USU_ID_USUARIO = ' || pSEG_USU_ID_USUARIO; END IF;
IF pCAD_PES_DT_NASCIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_DT_NASCIMENTO = TO_DATE('||CHR(39)||TO_CHAR(pCAD_PES_DT_NASCIMENTO,'DDMMYYYY')||CHR(39)||','||CHR(39)||'DDMMYYYY'||CHR(39)|| ')' ; END IF;
IF pCAD_PES_NR_RG IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NR_RG = ' || CHR(39) || pCAD_PES_NR_RG || CHR(39); END IF;
IF pCAD_PES_NM_RAZAOSOCIAL IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_RAZAOSOCIAL = ' || CHR(39) || '%' || pCAD_PES_NM_RAZAOSOCIAL || '%' || CHR(39); END IF;
IF pCAD_PES_CD_INSCR_ESTAD IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_CD_INSCR_ESTAD = ' || CHR(39) || pCAD_PES_CD_INSCR_ESTAD || CHR(39); END IF;
IF pCAD_PES_CD_INSCR_MUNIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_CD_INSCR_MUNIC = ' || CHR(39) || pCAD_PES_CD_INSCR_MUNIC || CHR(39); END IF;
IF pCAD_PES_TP_SEXO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_TP_SEXO = ' || CHR(39) || pCAD_PES_TP_SEXO || CHR(39); END IF;
IF pCAD_PES_CD_ESTADOCIVIL IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_CD_ESTADOCIVIL = ' || CHR(39) || pCAD_PES_CD_ESTADOCIVIL || CHR(39); END IF;
IF pCAD_PES_NM_NOMEMAE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_NOMEMAE = ' || CHR(39) || '%' || pCAD_PES_NM_NOMEMAE || '%' || CHR(39); END IF;
IF pCAD_PES_CD_ORGAOEMISSORRG IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_CD_ORGAOEMISSORRG = ' || CHR(39) || pCAD_PES_CD_ORGAOEMISSORRG || CHR(39); END IF;
IF pCAD_PES_DT_EXPEDICAORG IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_DT_EXPEDICAORG = ' || CHR(39) || pCAD_PES_DT_EXPEDICAORG || CHR(39); END IF;
IF pCAD_PES_TP_SANGUINEO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_TP_SANGUINEO = ' || CHR(39) || pCAD_PES_TP_SANGUINEO || CHR(39); END IF;
IF pCAD_PES_FL_SANGPOSITIVO_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_SANGPOSITIVO_OK = ' || CHR(39) || pCAD_PES_FL_SANGPOSITIVO_OK || CHR(39); END IF;
IF pAUX_PRF_CD_CODIGO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND AUX_PRF_CD_CODIGO = ' || pAUX_PRF_CD_CODIGO; END IF;
IF pAUX_NAC_CD_CODIGO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND AUX_NAC_CD_CODIGO = ' || pAUX_NAC_CD_CODIGO; END IF;
IF pCAD_PES_FL_DOADORORGAOS_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_DOADORORGAOS_OK = ' || CHR(39) || pCAD_PES_FL_DOADORORGAOS_OK || CHR(39); END IF;
IF pCAD_PES_NM_NATURALIDADE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_NATURALIDADE = ' || CHR(39) || '%' || pCAD_PES_NM_NATURALIDADE || '%' || CHR(39); END IF;
IF pAUX_ESC_CD_CODIGO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND AUX_ESC_CD_CODIGO = ' || pAUX_ESC_CD_CODIGO; END IF;
IF pCAD_PES_NM_NOMEPAI IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_NOMEPAI = ' || CHR(39) || '%' || pCAD_PES_NM_NOMEPAI || '%' || CHR(39); END IF;
IF pCAD_PES_NM_CONJUGE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_CONJUGE = ' || CHR(39) || '%' || pCAD_PES_NM_CONJUGE || '%' || CHR(39); END IF;
--IF pAUX_UFE_SG_UF IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND AUX_UFE_SG_UF = ' || CHR(39) || pAUX_UFE_SG_UF || CHR(39); END IF;
IF pCODCFO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CODCFO = ' || CHR(39) || pCODCFO || CHR(39); END IF;
IF pCAD_PES_CD_CNS_SUS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_CD_CNS_SUS = ' || CHR(39) || pCAD_PES_CD_CNS_SUS || CHR(39); END IF;
IF pCAD_PES_NOME_SOUNDEX IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NOME_SOUNDEX = ' || CHR(39) || pCAD_PES_NOME_SOUNDEX || CHR(39); END IF;
IF pCAD_PES_FL_ATIVO_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_ATIVO_OK = ' || CHR(39) || pCAD_PES_FL_ATIVO_OK || CHR(39); END IF;
IF pCAD_PES_NM_RN IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_NM_RN = ' || CHR(39) || pCAD_PES_NM_RN || CHR(39); END IF;
IF pCAD_PES_DT_NASC_RN IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_DT_NASC_RN = ' || CHR(39) || pCAD_PES_DT_NASC_RN || CHR(39); END IF;
IF pCAD_PES_TP_SEXO_RN IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_TP_SEXO_RN = ' || CHR(39) || pCAD_PES_TP_SEXO_RN || CHR(39); END IF;
IF pCAD_PES_FL_PRE_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_PRE_ATENDIMENTO = ' || CHR(39) || pCAD_PES_FL_PRE_ATENDIMENTO || CHR(39); END IF;
IF pCAD_PES_FL_EMAIL_INFORMADO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_EMAIL_INFORMADO = ' || CHR(39) || pCAD_PES_FL_EMAIL_INFORMADO || CHR(39); END IF;
IF pCAD_PES_DT_DESBLOQUEIO_CPF IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_DT_DESBLOQUEIO_CPF = ' || CHR(39) || pCAD_PES_DT_DESBLOQUEIO_CPF || CHR(39); END IF;
IF pSEG_USU_ID_USUARIO_DESB_CPF IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND SEG_USU_ID_USUARIO_DESB_CPF = ' || pSEG_USU_ID_USUARIO_DESB_CPF; END IF;

IF pCAD_PES_FL_CUIDADOINTEGRAL IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_CUIDADOINTEGRAL = ' || CHR(39) || pCAD_PES_FL_CUIDADOINTEGRAL || CHR(39); END IF;
IF pCAD_PES_FL_ISOLAMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PES_FL_ISOLAMENTO = ' || CHR(39) || pCAD_PES_FL_ISOLAMENTO || CHR(39); END IF;

   V_SELECT := '
SELECT
       CAD_PES_ID_PESSOA,
       CAD_PES_NR_CNPJ_CPF,
       CAD_PES_FL_JURIDICA_OK,
       CAD_PES_NM_PESSOA,
       CAD_PES_DT_ULTIMA_ATUALIZACAO,
       SEG_USU_ID_USUARIO,
       CAD_PES_DT_NASCIMENTO,
       CAD_PES_NR_RG,
       CAD_PES_NM_RAZAOSOCIAL,
       CAD_PES_CD_INSCR_ESTAD,
       CAD_PES_CD_INSCR_MUNIC,
       CAD_PES_TP_SEXO,
       CAD_PES_CD_ESTADOCIVIL,
       CAD_PES_NM_NOMEMAE,
       CAD_PES_CD_ORGAOEMISSORRG,
       CAD_PES_DT_EXPEDICAORG,
       CAD_PES_TP_SANGUINEO,
       CAD_PES_FL_SANGPOSITIVO_OK,
       AUX_PRF_CD_CODIGO,
       AUX_NAC_CD_CODIGO,
       CAD_PES_FL_DOADORORGAOS_OK,
       CAD_PES_NM_NATURALIDADE,
       AUX_ESC_CD_CODIGO,
       CAD_PES_NM_NOMEPAI,
       CAD_PES_NM_CONJUGE,
       AUX_UFE_SG_UF,
       CODCFO,
       CAD_PES_CD_CNS_SUS,
       CAD_PES_NOME_SOUNDEX,
       CAD_PES_FL_ATIVO_OK,
       CAD_PES_NM_RN,
	     CAD_PES_DT_NASC_RN,
	     CAD_PES_TP_SEXO_RN,
       CAD_PES_FL_PRE_ATENDIMENTO,
       CAD_PES_FL_EMAIL_INFORMADO,
       CAD_PES_DT_DESBLOQUEIO_CPF,
       SEG_USU_ID_USUARIO_DESB_CPF,
       CAD_PES_FL_CUIDADOINTEGRAL,
       CAD_PES_FL_ISOLAMENTO
       
FROM TB_CAD_PES_PESSOA
WHERE null is null
'   ;
--TESTE :=   V_SELECT || V_WHERE ;
OPEN v_cursor FOR
  V_SELECT || V_WHERE ;
  io_cursor := v_cursor;
  end PRC_CAD_PES_PESSOA_RMT_S;
