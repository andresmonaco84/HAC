--PRC_ASS_PAP_PAC_ATEN_PROC_R_L
create or replace procedure PRC_ASS_PAP_PAC_ATEN_PROC_R_L 
(
     pATD_ATE_ID IN TB_ASS_PAP_PAC_ATEN_PROC.ATD_ATE_ID%type DEFAULT NULL,
     pCAD_PRD_ID IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_PRD_ID%type DEFAULT NULL,
     pCAD_PAC_ID_PACIENTE IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_PAC_ID_PACIENTE%type DEFAULT NULL,
     pASS_PAP_QT_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_QT_SOLIC%type DEFAULT NULL,
     pASS_PAP_DT_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DT_SOLIC%type DEFAULT NULL,
     pASS_PAP_FL_STATUS_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_STATUS_SOLIC%type DEFAULT NULL,
     pASS_PAP_HR_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_HR_SOLIC%type DEFAULT NULL,
     pASS_PAP_QT_AUTOR IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_QT_AUTOR%type DEFAULT NULL,
     pASS_PAP_DT_AUTOR IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DT_AUTOR%type DEFAULT NULL,
     pASS_PAP_HR_AUTOR IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_HR_AUTOR%type DEFAULT NULL,
     pASS_PAP_FL_STATUS_AUTOR IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_STATUS_AUTOR%type DEFAULT NULL,
     pASS_PAP_QT_REALIZ IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_QT_REALIZ%type DEFAULT NULL,
     pASS_PAP_DT_REALIZ IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DT_REALIZ%type DEFAULT NULL,
     pASS_PAP_HR_INI_REALIZ IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_HR_INI_REALIZ%type DEFAULT NULL,
     pASS_PAP_HR_FIM_REALIZ IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_HR_FIM_REALIZ%type DEFAULT NULL,
     pASS_PAP_FL_STATUS_REALIZ IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_STATUS_REALIZ%type DEFAULT NULL,
     pSEG_USU_ID_USUARIO IN TB_ASS_PAP_PAC_ATEN_PROC.SEG_USU_ID_USUARIO%type DEFAULT NULL,
     pASS_PAP_NR_CONTA IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_NR_CONTA%type DEFAULT NULL,
     pASS_PAP_DT_ULTIMA_ATUALIZACAO IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DT_ULTIMA_ATUALIZACAO%type DEFAULT NULL,
     pASS_PAP_ID IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_ID%type DEFAULT NULL,
     pASS_PAP_FL_ORIGEM IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_ORIGEM%type DEFAULT NULL,
     pCAD_UNI_ID_UNIDADE IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_UNI_ID_UNIDADE%type DEFAULT NULL,
     pCODPAD IN TB_ASS_PAP_PAC_ATEN_PROC.CODPAD%type DEFAULT NULL,
     pATD_ATE_NR_CONSELHO_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ATD_ATE_NR_CONSELHO_SOLIC%type DEFAULT NULL,
     pATD_ATE_CD_UFCONSELHO_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ATD_ATE_CD_UFCONSELHO_SOLIC%type DEFAULT NULL,
     pTIS_CPR_CD_CONSELHOPROF_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.TIS_CPR_CD_CONSELHOPROF_SOLIC%type DEFAULT NULL,
     pCAD_LAT_ID_LOCAL_ATENDIMENTO IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_LAT_ID_LOCAL_ATENDIMENTO%type DEFAULT NULL,
     pASS_PAP_NM_ATENDENTE_PLANO IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_NM_ATENDENTE_PLANO%type DEFAULT NULL,
     pCAD_CLC_ID IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_CLC_ID%type DEFAULT NULL,
     pASS_PAP_DS_OBSERVACAO IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DS_OBSERVACAO%type DEFAULT NULL,
     pCAD_SET_ID_SETOR_LIBERACAO IN TB_ASS_PAP_PAC_ATEN_PROC.CAD_SET_ID_SETOR_LIBERACAO%type DEFAULT NULL,
     pASS_PAP_DS_RET_AUTORIZADOR IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DS_RET_AUTORIZADOR%type DEFAULT NULL,
     pASS_PAP_FL_CARATER_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_CARATER_SOLIC%type DEFAULT NULL,
     pASS_PAP_FL_AUTORIZ_MANUAL_OK IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_AUTORIZ_MANUAL_OK%type DEFAULT NULL,
     pASS_PAP_FL_ACIDENTE_TRAB_OK IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_ACIDENTE_TRAB_OK%type DEFAULT NULL,
     pASS_PAP_FL_SEM_GUIA_OK IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_FL_SEM_GUIA_OK%type DEFAULT NULL,
     pASS_PAP_DT_VALIDADE IN TB_ASS_PAP_PAC_ATEN_PROC.ASS_PAP_DT_VALIDADE%type DEFAULT NULL,
     pFAT_CCI_ID IN TB_ASS_PAP_PAC_ATEN_PROC.FAT_CCI_ID%type DEFAULT NULL,
     pTIS_CBO_CD_CBOS_SOLIC IN TB_ASS_PAP_PAC_ATEN_PROC.TIS_CBO_CD_CBOS_SOLIC%type DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor
) 
is
/********************************************************************
*    Procedure: PRC_ASS_PAP_PAC_ATEN_PROC_R_L
* 
*    Data Criacao: 	data da  criação   Por: Nome do Analista
*    Data Alteracao:	21/10/2014  Por: Andrea Cazuca
*    Alteracao:  Inclusão do campo TIS_CBO_CD_CBOS_SOLIC
*
*    Funcao: Descrição da funcionalidade da Stored Procedure
*
*******************************************************************/
 v_cursor PKG_CURSOR.t_cursor;
  V_WHERE  varchar2(5000);
  V_SELECT  varchar2(5000);
begin
  V_WHERE := NULL;
  IF pATD_ATE_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_ID = ' || pATD_ATE_ID; END IF;
IF pCAD_PRD_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PRD_ID = ' || pCAD_PRD_ID; END IF;
IF pCAD_PAC_ID_PACIENTE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_PAC_ID_PACIENTE = ' || pCAD_PAC_ID_PACIENTE; END IF;
IF pASS_PAP_QT_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_QT_SOLIC = ' || pASS_PAP_QT_SOLIC; END IF;
IF pASS_PAP_DT_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DT_SOLIC = ' || CHR(39) || pASS_PAP_DT_SOLIC || CHR(39); END IF;
IF pASS_PAP_FL_STATUS_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_STATUS_SOLIC = ' || CHR(39) || pASS_PAP_FL_STATUS_SOLIC || CHR(39); END IF;
IF pASS_PAP_HR_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_HR_SOLIC = ' || pASS_PAP_HR_SOLIC; END IF;
IF pASS_PAP_QT_AUTOR IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_QT_AUTOR = ' || pASS_PAP_QT_AUTOR; END IF;
IF pASS_PAP_DT_AUTOR IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DT_AUTOR = ' || CHR(39) || pASS_PAP_DT_AUTOR || CHR(39); END IF;
IF pASS_PAP_HR_AUTOR IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_HR_AUTOR = ' || pASS_PAP_HR_AUTOR; END IF;
IF pASS_PAP_FL_STATUS_AUTOR IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_STATUS_AUTOR = ' || CHR(39) || pASS_PAP_FL_STATUS_AUTOR || CHR(39); END IF;
IF pASS_PAP_QT_REALIZ IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_QT_REALIZ = ' || pASS_PAP_QT_REALIZ; END IF;
IF pASS_PAP_DT_REALIZ IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DT_REALIZ = ' || CHR(39) || pASS_PAP_DT_REALIZ || CHR(39); END IF;
IF pASS_PAP_HR_INI_REALIZ IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_HR_INI_REALIZ = ' || pASS_PAP_HR_INI_REALIZ; END IF;
IF pASS_PAP_HR_FIM_REALIZ IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_HR_FIM_REALIZ = ' || pASS_PAP_HR_FIM_REALIZ; END IF;
IF pASS_PAP_FL_STATUS_REALIZ IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_STATUS_REALIZ = ' || CHR(39) || pASS_PAP_FL_STATUS_REALIZ || CHR(39); END IF;
IF pSEG_USU_ID_USUARIO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND SEG_USU_ID_USUARIO = ' || pSEG_USU_ID_USUARIO; END IF;
IF pASS_PAP_NR_CONTA IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_NR_CONTA = ' || pASS_PAP_NR_CONTA; END IF;
IF pASS_PAP_DT_ULTIMA_ATUALIZACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DT_ULTIMA_ATUALIZACAO = ' || CHR(39) || pASS_PAP_DT_ULTIMA_ATUALIZACAO || CHR(39); END IF;
IF pASS_PAP_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_ID = ' || pASS_PAP_ID; END IF;
IF pASS_PAP_FL_ORIGEM IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_ORIGEM = ' || CHR(39) || pASS_PAP_FL_ORIGEM || CHR(39); END IF;
IF pCAD_UNI_ID_UNIDADE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_UNI_ID_UNIDADE = ' || pCAD_UNI_ID_UNIDADE; END IF;
IF pCODPAD IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CODPAD = ' || CHR(39) || pCODPAD || CHR(39); END IF;
IF pATD_ATE_NR_CONSELHO_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_NR_CONSELHO_SOLIC = ' || CHR(39) || pATD_ATE_NR_CONSELHO_SOLIC || CHR(39); END IF;
IF pATD_ATE_CD_UFCONSELHO_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ATD_ATE_CD_UFCONSELHO_SOLIC = ' || CHR(39) || pATD_ATE_CD_UFCONSELHO_SOLIC || CHR(39); END IF;
IF pTIS_CPR_CD_CONSELHOPROF_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_CPR_CD_CONSELHOPROF_SOLIC = ' || CHR(39) || pTIS_CPR_CD_CONSELHOPROF_SOLIC || CHR(39); END IF;
IF pCAD_LAT_ID_LOCAL_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_LAT_ID_LOCAL_ATENDIMENTO = ' || pCAD_LAT_ID_LOCAL_ATENDIMENTO; END IF;
IF pASS_PAP_NM_ATENDENTE_PLANO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_NM_ATENDENTE_PLANO = ' || CHR(39) || pASS_PAP_NM_ATENDENTE_PLANO || CHR(39); END IF;
IF pCAD_CLC_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_CLC_ID = ' || pCAD_CLC_ID; END IF;
IF pASS_PAP_DS_OBSERVACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DS_OBSERVACAO = ' || CHR(39) || pASS_PAP_DS_OBSERVACAO || CHR(39); END IF;
IF pCAD_SET_ID_SETOR_LIBERACAO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CAD_SET_ID_SETOR_LIBERACAO = ' || pCAD_SET_ID_SETOR_LIBERACAO; END IF;
IF pASS_PAP_DS_RET_AUTORIZADOR IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DS_RET_AUTORIZADOR = ' || CHR(39) || pASS_PAP_DS_RET_AUTORIZADOR || CHR(39); END IF;
IF pASS_PAP_FL_CARATER_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_CARATER_SOLIC = ' || CHR(39) || pASS_PAP_FL_CARATER_SOLIC || CHR(39); END IF;
IF pASS_PAP_FL_AUTORIZ_MANUAL_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_AUTORIZ_MANUAL_OK = ' || CHR(39) || pASS_PAP_FL_AUTORIZ_MANUAL_OK || CHR(39); END IF;
IF pASS_PAP_FL_ACIDENTE_TRAB_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_ACIDENTE_TRAB_OK = ' || CHR(39) || pASS_PAP_FL_ACIDENTE_TRAB_OK || CHR(39); END IF;
IF pASS_PAP_FL_SEM_GUIA_OK IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_FL_SEM_GUIA_OK = ' || CHR(39) || pASS_PAP_FL_SEM_GUIA_OK || CHR(39); END IF;
IF pASS_PAP_DT_VALIDADE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ASS_PAP_DT_VALIDADE = ' || CHR(39) || pASS_PAP_DT_VALIDADE || CHR(39); END IF;
IF pFAT_CCI_ID IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND FAT_CCI_ID = ' || pFAT_CCI_ID; END IF;
IF pTIS_CBO_CD_CBOS_SOLIC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND TIS_CBO_CD_CBOS_SOLIC = '|| pTIS_CBO_CD_CBOS_SOLIC; END IF;
 
   V_SELECT := '
SELECT	
       ATD_ATE_ID,
       CAD_PRD_ID,
       CAD_PAC_ID_PACIENTE,
       ASS_PAP_QT_SOLIC,
       ASS_PAP_DT_SOLIC,
       ASS_PAP_FL_STATUS_SOLIC,
       ASS_PAP_HR_SOLIC,
       ASS_PAP_QT_AUTOR,
       ASS_PAP_DT_AUTOR,
       ASS_PAP_HR_AUTOR,
       ASS_PAP_FL_STATUS_AUTOR,
       ASS_PAP_QT_REALIZ,
       ASS_PAP_DT_REALIZ,
       ASS_PAP_HR_INI_REALIZ,
       ASS_PAP_HR_FIM_REALIZ,
       ASS_PAP_FL_STATUS_REALIZ,
       SEG_USU_ID_USUARIO,
       ASS_PAP_NR_CONTA,
       ASS_PAP_DT_ULTIMA_ATUALIZACAO,
       ASS_PAP_ID,
       ASS_PAP_FL_ORIGEM,
       CAD_UNI_ID_UNIDADE,
       CODPAD,
       ATD_ATE_NR_CONSELHO_SOLIC,
       ATD_ATE_CD_UFCONSELHO_SOLIC,
       TIS_CPR_CD_CONSELHOPROF_SOLIC,
       CAD_LAT_ID_LOCAL_ATENDIMENTO,
       ASS_PAP_NM_ATENDENTE_PLANO,
       CAD_CLC_ID,
       ASS_PAP_DS_OBSERVACAO,
       CAD_SET_ID_SETOR_LIBERACAO,
       ASS_PAP_DS_RET_AUTORIZADOR,
       ASS_PAP_FL_CARATER_SOLIC,
       ASS_PAP_FL_AUTORIZ_MANUAL_OK,
       ASS_PAP_FL_ACIDENTE_TRAB_OK,
       ASS_PAP_FL_SEM_GUIA_OK,
       ASS_PAP_DT_VALIDADE,
       FAT_CCI_ID,
       TIS_CBO_CD_CBOS_SOLIC
FROM TB_ASS_PAP_PAC_ATEN_PROC
WHERE null is null  '    ;
       
OPEN v_cursor FOR
  V_SELECT || V_WHERE ;
  io_cursor := v_cursor;
end PRC_ASS_PAP_PAC_ATEN_PROC_R_L;
/
