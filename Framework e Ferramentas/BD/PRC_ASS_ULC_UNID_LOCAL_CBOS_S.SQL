create or replace procedure PRC_ASS_ULC_UNID_LOCAL_CBOS_S
  (
     pCAD_UNI_ID_UNIDADE IN TB_ASS_ULC_UNID_LOCAL_CBOS.CAD_UNI_ID_UNIDADE%type,
     pCAD_LAT_ID_LOCAL_ATENDIMENTO IN TB_ASS_ULC_UNID_LOCAL_CBOS.CAD_LAT_ID_LOCAL_ATENDIMENTO%type DEFAULT NULL,
     pTIS_CBO_CD_CBOS IN TB_ASS_ULC_UNID_LOCAL_CBOS.TIS_CBO_CD_CBOS%type DEFAULT NULL,
     pASS_ULC_FL_STATUS IN TB_ASS_ULC_UNID_LOCAL_CBOS.ASS_ULC_FL_STATUS%type DEFAULT NULL,
     pTIS_CBO_DS_CBOS_HAC IN TB_TIS_CBO_CBOS.TIS_CBO_DS_CBOS_HAC%type DEFAULT NULL,
   --  pASS_ULC_CD_PROGRAMA_ACS IN TB_ASS_ULC_UNID_LOCAL_CBOS.ASS_ULC_CD_PROGRAMA_ACS%type DEFAULT NULL,
     io_cursor OUT PKG_CURSOR.t_cursor
  )
  is
 /********************************************************************
  *    Procedure: PRC_ASS_ULC_UNID_LOCAL_CBOS_S
  *
  *    Data Alteracao:  26/08/2011  Por: Pedro
  *    Alterac?o: Alterac?o de tabela
  *    Data Alteracao:  31/08/2011  Por: Eduardo
  *    Alteracao: "like" ao invés de "=" para CBO.TIS_CBO_DS_CBOS_HAC
  *
  *******************************************************************/
 v_cursor PKG_CURSOR.t_cursor;
  V_WHERE  varchar2(3000);
  V_SELECT  varchar2(3000);
begin
  V_WHERE := NULL;
  IF pCAD_UNI_ID_UNIDADE IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ULC.CAD_UNI_ID_UNIDADE = ' || pCAD_UNI_ID_UNIDADE; END IF;
IF pCAD_LAT_ID_LOCAL_ATENDIMENTO IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ULC.CAD_LAT_ID_LOCAL_ATENDIMENTO = ' || pCAD_LAT_ID_LOCAL_ATENDIMENTO; END IF;
IF pTIS_CBO_CD_CBOS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ULC.TIS_CBO_CD_CBOS = ' || CHR(39) || pTIS_CBO_CD_CBOS || CHR(39); END IF;
IF pASS_ULC_FL_STATUS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ULC.ASS_ULC_FL_STATUS = ' || CHR(39) || pASS_ULC_FL_STATUS || CHR(39); END IF;
IF pTIS_CBO_DS_CBOS_HAC IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND CBO.TIS_CBO_DS_CBOS_HAC like ' || CHR(39) || pTIS_CBO_DS_CBOS_HAC || CHR(39); END IF;
--IF pASS_ULC_CD_PROGRAMA_ACS IS NOT NULL THEN V_WHERE:= V_WHERE || ' AND ULC.ASS_ULC_CD_PROGRAMA_ACS = ' || CHR(39) || pASS_ULC_CD_PROGRAMA_ACS || CHR(39); END IF;

  V_SELECT := '
    SELECT
       ULC.CAD_UNI_ID_UNIDADE,
       ULC.CAD_LAT_ID_LOCAL_ATENDIMENTO,
       ULC.TIS_CBO_CD_CBOS,
       -- ASS_ULC_QTD_ATEND_HORA,
       ULC.ASS_ULC_FL_STATUS,
      -- ULC.ASS_ULC_CD_PROGRAMA_ACS,
       CBO.*
    FROM TB_ASS_ULC_UNID_LOCAL_CBOS ULC,
         TB_TIS_CBO_CBOS CBO
    WHERE
    ULC.TIS_CBO_CD_CBOS = CBO.TIS_CBO_CD_CBOS'
 ;
OPEN v_cursor FOR
  V_SELECT || V_WHERE ;
  io_cursor := v_cursor;
  end PRC_ASS_ULC_UNID_LOCAL_CBOS_S;
